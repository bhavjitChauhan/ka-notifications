(()=>{"use strict";var e={262:(e,n,t)=>{t.r(n)},626:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getNotificationCount=n.getNotificationData=n.createOffscreenHeartbeat=void 0;const a=t(921);n.createOffscreenHeartbeat=async function(){await chrome.offscreen.hasDocument()||await chrome.offscreen.createDocument({url:chrome.runtime.getURL("heartbeat.html"),reasons:[chrome.offscreen.Reason.BLOBS],justification:"Keep service worker alive."})},n.getNotificationData=async function(e,n){const t=await(0,a.graphQLFetchJsonResponse)("getNotificationsForUser",e,void 0===n?void 0:{after:n});if(t?.cookieError)return{error:"cookie"};if(!t?.value)return{};const r=t.value?.data?.user?.notifications;return r?{value:{notifications:r.notifications,cursor:r.pageInfo.nextCursor}}:{error:"nonotifications"}},n.getNotificationCount=async function(e){const n=await(0,a.graphQLFetchJsonResponse)("getFullUserProfile",e);if(!n?.value)return{};const t=n.value?.data?.user;return t?{value:t.newNotificationCount}:{error:"!user",value:t}}},921:function(e,n,t){var a=this&&this.__createBinding||(Object.create?function(e,n,t,a){void 0===a&&(a=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&!("get"in r?!n.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,a,r)}:function(e,n,t,a){void 0===a&&(a=t),e[a]=n[t]}),r=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&a(n,e,t);return r(n,e),n};Object.defineProperty(n,"__esModule",{value:!0}),n.addFeedback=n.graphQLFetchJsonResponse=n.getUserFkeyCookie=n.graphQLFetch=void 0;const i=s(t(593)),o=t(448),c=i;async function l(e,n,t={}){const a=`https://www.khanacademy.org/api/internal/graphql/${e}?/fastly/`,r={method:"POST",headers:{"X-KA-fkey":n,"Content-Type":"application/json"},body:JSON.stringify({operationName:e,query:c[e],variables:t}),credentials:"same-origin"},s=await fetch(a,r);if(200===s.status)return s;if(400===s.status){const n=c[e].startsWith("mutation");console.warn(`The query for operation "${e}" is no longer in the safelist. Attempting to fetch the latest version from the safelist...`);const s=n?await(0,o.getLatestMutation)(e):await(0,o.getLatestQuery)(e);if(!s)throw new Error(`The query for operation "${e}" was not found in the safelist`);r.body=JSON.stringify({operationName:e,query:s,variables:t});const i=await fetch(a,r);if(200===i.status)return c[e]=s,i;throw new Error(`Error in GraphQL "${e}" call: Server responded with status ${i.status}.`)}throw new Error(`Error in GraphQL "${e}" call: Server responded with status ${s.status}.`)}async function d(){return new Promise(((e,n)=>{chrome.cookies.get({url:"https://www.khanacademy.org",name:"fkey"},(t=>{null===t?n("No fkey cookie found."):e(t.value)}))}))}n.graphQLFetch=l,n.getUserFkeyCookie=d,n.graphQLFetchJsonResponse=async function(e,n,t={}){let a;if(void 0!==n)a=n;else try{a=await d()}catch(e){return{cookieError:!0}}try{const n=await l(e,a,t);return{value:await n.json()}}catch(e){return e instanceof Error&&"Failed to fetch"===e.message?console.log("Possible network disconnect detected, please check your internet connection."):console.error("Error in response: ",e),{value:null}}},n.addFeedback=async function(e,n,t,a,r){try{const s=new URL("https://www.khanacademy.org/"+n).searchParams;let i,o,c="scratchpad";if("ResponseFeedbackNotification"===t)i="ANSWER"===a?"QUESTION":"COMMENT",o="REPLY",c=s.get("qa_expand_type");else{if("ProgramFeedbackNotification"!==t)return!1;i=a,o="QUESTION"===a?"ANSWER":"REPLY"}const d=n.split("?")[0].split("/").pop(),u=await l("feedbackQuery",e,{topicId:d,feedbackType:i,currentSort:5,qaExpandKey:s.get("qa_expand_key"),focusKind:c}),p=(await u.json()).data.feedback.feedback[0],y="QUESTION"===a&&"answer"===s.get("qa_expand_type")?p.answers[0].key:p.key;return(await l("AddFeedbackToDiscussion",e,{parentKey:y,textContent:r,feedbackType:o,fromVideoAuthor:!1,shownLowQualityNotice:!1})).ok}catch(e){return console.error("Error in sending feedback: ",e),!1}}},310:(e,n)=>{function t(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}Object.defineProperty(n,"__esModule",{value:!0}),n.cleanse=n.parseMarkdown=void 0,n.parseMarkdown=function(e){e=t(e);const n=[],a=[];let r=e=(e=e.replace(/```([\s\S]*?)```/gm,((e,t)=>(n.push(t),`<codeblock-placeholder-${n.length-1}>`)))).replace(/`([^\n]+?)`/g,((e,n)=>(a.push(n),`<codeinline-placeholder-${a.length-1}>`)));for(let n=0;n<100&&(e=(e=(e=e.replace(/\*([^\n]+?)\*/g,"<b>$1</b>")).replace(/_([^\n]+?)_/g,"<i>$1</i>")).replace(/~([^\n]+?)~/g,"<s>$1</s>"))!==r;n++)r=e;return(e=(e=(e=e.replace(/<codeblock-placeholder-(\d+)>/g,((e,t)=>`<pre><code>${n[parseInt(t)]}</code></pre>`))).replace(/<codeinline-placeholder-(\d+)>/g,((e,n)=>`<code>${a[parseInt(n)]}</code>`))).replace(/((?:http|https)(?:.*?))(?:\s|$)/g,'<a class="hyperlink" href="$1" target="_blank">$1</a>')).replace(/@([a-zA-Z][a-zA-Z\d]{0,39})/g,'<a class="hyperlink" href="https://www.khanacademy.org/profile/$1" target="_blank">@$1</a>')},n.cleanse=t},503:function(e,n,t){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.initUserInterface=n.createLoggedOutString=n.createNoCookieString=n.createNoNotificationsString=n.addReplyButtonEventListeners=n.createNotificationString=void 0;const r=t(921),s=t(310),i=a(t(26)),o=a(t(489)),c=i.default,l=o.default;function d(e){const n=((new Date).getTime()-e.getTime())/1e3|0;if(n<60)return`${n} second${1===n?"":"s"}`;if(n<3600){const e=n/60|0;return`${e} minute${1===e?"":"s"}`}if(n<86400){const e=n/3600|0;return`${e} hour${1===e?"":"s"}`}if(n<2592e3){const e=n/86400|0;return`${e} day${1===e?"":"s"}`}if(n<31536e3){const e=n/2592e3|0;return`${e} month${1===e?"":"s"}`}const t=n/31536e3|0;return`${t} year${1===t?"":"s"}`}function u(e){const n=document.getElementById("active-textarea");if(n){const e=n.parentElement.getElementsByClassName("notification-feedback-button")[0];e.removeEventListener("click",p),e.addEventListener("click",u),e.textContent="Reply",n.remove()}const t=e.target;t.removeEventListener("click",u),t.addEventListener("click",p),t.textContent="Cancel";const a=document.createElement("textarea");a.id="active-textarea",a.oninput=()=>{0===a.value.length?t.textContent="Cancel":t.textContent="Send",a.style.height="0",a.style.height=`${a.scrollHeight+2}px`},t.insertAdjacentElement("beforebegin",a),a.focus()}async function p(e){const n=e.target,t=document.getElementById("active-textarea");if(0===t.value.length)return n.textContent="Reply",n.removeEventListener("click",p),n.addEventListener("click",u),void t.remove();const{value:a}=t,{url:s,typename:i,feedbacktype:o}=n.dataset;n.textContent="Sending...",t.disabled=!0;try{const e=await(0,r.getUserFkeyCookie)();await(0,r.addFeedback)(e,s,i,o,a)?(n.textContent="Success!",window.setTimeout((()=>{n.textContent="Reply",t.remove()}),5e3)):(t.value="Error in sending request.",n.textContent="Failure!")}catch(e){console.error("Error in sending message: "+a+"; "+e),t.value="Error in sending request: "+e}}n.createNotificationString=function(e){const{brandNew:n,date:t,url:a}=e;switch(e.__typename){case"ResponseFeedbackNotification":return`<li class="notification ${n?"new":""}"><div class="notification-header"><img class="notification-author-avatar" src="${e.authorAvatarUrl}"><h3 class="notification-author-nickname">${(0,s.cleanse)(e.authorNickname)}</h3><a class="hyperlink" href="https://www.khanacademy.org${a}" target="_blank">${"REPLY"===e.feedbackType?"added a comment":"answered your question"} on ${e.focusTranslatedTitle}</a><span class="notification-date">${d(new Date(t))} ago</span></div><div class="notification-content">${(0,s.parseMarkdown)(e.content)}</div><div class="notification-feedback-container"><button class="notification-feedback-button add-listeners" data-url="${a}" data-typename="ResponseFeedbackNotification" data-feedbacktype="${e.feedbackType}">Reply</button></div></li>`;case"ProgramFeedbackNotification":return`<li class="notification ${n?"new":""}"><div class="notification-header"><img class="notification-author-avatar" src="${e.authorAvatarSrc}"><h3 class="notification-author-nickname">${(0,s.cleanse)(e.authorNickname)}</h3><a class="hyperlink" href="https://www.khanacademy.org${a}" target="_blank">${"COMMENT"===e.feedbackType?"commented":"asked a question"} on ${(0,s.cleanse)(e.translatedScratchpadTitle)}</a><span class="notification-date">${d(new Date(t))} ago</span></div><div class="notification-content">${(0,s.parseMarkdown)(e.content)}</div><div class="notification-feedback-container"><button class="notification-feedback-button add-listeners" data-url="${a}" data-typename="ProgramFeedbackNotification" data-feedbacktype="${e.feedbackType}">Reply</button></div></li>`;case"AvatarNotification":return`<li class="notification ${n?"new":""}"><div class="notification-header"><img class="notification-author-avatar" src="${e.thumbnailSrc.startsWith("https://cdn.kastatic.org/")?e.thumbnailSrc:"https://cdn.kastatic.org"+e.thumbnailSrc}"><h3 class="notification-author-nickname">KA Avatars</h3><a class="hyperlink" href="https://www.khanacademy.org${a}" target="_blank">use avatar</a><span class="notification-date">${d(new Date(t))} ago</span></div><div class="notification-content">You unlocked <b>${l[e.name]}</b>! <i>${c[e.name]}</i></div></li>`;case"GroupedBadgeNotification":return`<li class="notification ${n?"new":""}"><div class="notification-header"><img class="notification-author-avatar" src="${e.badgeNotifications[0].badge.icons.compactUrl}"><h3 class="notification-author-nickname">KA Badges</h3><a class="hyperlink" href="https://www.khanacademy.org${e.url}" target="_blank">view badges</a><span class="notification-date">${d(new Date(t))} ago</span></div><p class="notification-content">You earned <b>${e.badgeNotifications[0].badge.description}</b> and ${e.badgeNotifications.length-1} more! Congratulations!</p></li>`;case"BadgeNotification":return`<li class="notification ${n?"new":""}"><div class="notification-header"><img class="notification-author-avatar" src="${e.badge.icons.compactUrl}"><h3 class="notification-author-nickname">KA Badges</h3><a class="hyperlink" href="https://www.khanacademy.org/${e.badge.relativeUrl}" target="_blank">view badge</a><span class="notification-date">${d(new Date(t))}</span></div><div class="notification-content">You earned <b>${e.badge.description}</b>! <i>${e.badge.fullDescription}</i>.</div></li>`;default:return console.log(`Notification type ${e.__typename} is currently unsupported.`),`<li class="notification ${n?"new":""}"><div class="notification-header"><img class="notification-author-avatar" src="48.png"><h3 class="notification-author-nickname">Unsupported Notification Type</h3><span class="notification-date">${d(new Date(t))} ago</span></div><div class="notification-content">${JSON.stringify(e)}</div></li>`}},n.addReplyButtonEventListeners=function(){const e=document.getElementsByClassName("add-listeners");for(let n=e.length;n--;)e[n].addEventListener("click",u),e[n].className="notification-feedback-button"},n.createNoNotificationsString=function(){return'<li class="notification new"><div class="notification-header"><img class="notification-author-avatar" src="32.png"><h3 class="notification-author-nickname">KA Notifications</h3></div><div class="notification-content">You have no notifications.</div></li>'},n.createNoCookieString=function(){return'<li class="notification new"><div class="notification-header"><img class="notification-author-avatar" src="32.png"><h3 class="notification-author-nickname">KA Notifications</h3></div><div class="notification-content">Your authentication cookie has expired. Please <a class="hyperlink" href="https://khanacademy.org/" target="_blank">navigate to Khan Academy</a> to refresh it.</div></li>'},n.createLoggedOutString=function(){return'<li class="notification new"><div class="notification-header"><img class="notification-author-avatar" src="32.png"><h3 class="notification-author-nickname">KA Notifications</h3></div><div class="notification-content">You are logged out. Please <a class="hyperlink" href="https://khanacademy.org/login" target="_blank">log in to Khan Academy</a> to use this extension.</div></li>'},n.initUserInterface=function(e){const n=document.getElementById("theme-button");"dark"===e&&(document.body.className=e,n.innerHTML='<svg stroke="#ffffff" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="18px" width="18px" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>'),n.onclick=()=>{"dark"===document.body.className?(chrome.storage.local.remove("theme"),n.innerHTML='<svg stroke="#ffffff" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="18px" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>',document.body.className=""):(chrome.storage.local.set({theme:"dark"}),n.innerHTML='<svg stroke="#ffffff" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="18px" width="18px" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>',document.body.className="dark")};const t=document.getElementById("mark-all-read"),a=document.getElementById("mark-all-read-loading");let s=!1;t.onclick=async()=>{if(!s){s=!0,a.classList.remove("hidden");try{const e=await(0,r.getUserFkeyCookie)();(await(0,r.graphQLFetchJsonResponse)("clearBrandNewNotifications",e)).value&&(s=!1,a.classList.add("hidden"),chrome.action.setBadgeText({text:""}))}catch(e){a.classList.add("hidden"),console.error(e)}}};const i=document.getElementById("settings-button"),o=document.getElementById("notifications-section"),c=document.getElementById("settings-section");i.onclick=()=>{o.classList.toggle("hidden"),c.classList.toggle("hidden"),c.classList.contains("hidden")?(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 96 960 960" width="18"><path fill="#ffffff" d="m388 976-20-126q-19-7-40-19t-37-25l-118 54-93-164 108-79q-2-9-2.5-20.5T185 576q0-9 .5-20.5T188 535L80 456l93-164 118 54q16-13 37-25t40-18l20-127h184l20 126q19 7 40.5 18.5T669 346l118-54 93 164-108 77q2 10 2.5 21.5t.5 21.5q0 10-.5 21t-2.5 21l108 78-93 164-118-54q-16 13-36.5 25.5T592 850l-20 126H388Zm92-270q54 0 92-38t38-92q0-54-38-92t-92-38q-54 0-92 38t-38 92q0 54 38 92t92 38Zm0-60q-29 0-49.5-20.5T410 576q0-29 20.5-49.5T480 506q29 0 49.5 20.5T550 576q0 29-20.5 49.5T480 646Zm0-70Zm-44 340h88l14-112q33-8 62.5-25t53.5-41l106 46 40-72-94-69q4-17 6.5-33.5T715 576q0-17-2-33.5t-7-33.5l94-69-40-72-106 46q-23-26-52-43.5T538 348l-14-112h-88l-14 112q-34 7-63.5 24T306 414l-106-46-40 72 94 69q-4 17-6.5 33.5T245 576q0 17 2.5 33.5T254 643l-94 69 40 72 106-46q24 24 53.5 41t62.5 25l14 112Z"/></svg>',i.title="Show Settings"):(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 96 960 960" width="18"><path fill="#fff" d="M480 896 160 576l320-320 42 42-248 248h526v60H274l248 248-42 42Z"/></svg>',i.title="Show Notifications")};const l=document.getElementById("sort-comments");(async()=>{const{commentSort:e}=await chrome.storage.local.get("commentSort");l.value=e||"Top Voted"})(),l.onchange=()=>{chrome.storage.local.set({commentSort:l.value})}}},448:(e,n,t)=>{t.r(n),(()=>{var e,n,t=Object.create,a=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,c=(e,n)=>{for(var t in n)a(e,t,{get:n[t],enumerable:!0})},l=(e,n,t,i)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let c of s(n))o.call(e,c)||c===t||a(e,c,{get:()=>n[c],enumerable:!(i=r(n,c))||i.enumerable});return e},d=(e,n,t)=>{if(!n.has(e))throw TypeError("Cannot "+t)},u=(e,n,t)=>(d(e,n,"read from private field"),t?t.call(e):n.get(e)),p=(e,n,t)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,t)},y=(e,n,t,a)=>(d(e,n,"write to private field"),a?a.call(e,t):n.set(e,t),t),h=(e,n,t)=>(d(e,n,"access private method"),t),m=(e={".yarn/cache/cross-fetch-npm-4.0.0-9c67668db4-ecca4f37ff.zip/node_modules/cross-fetch/dist/browser-ponyfill.js"(e,n){var t,a="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global,r=function(){function e(){this.fetch=!1,this.DOMException=a.DOMException}return e.prototype=a,new e}();t=r,function(e){var n=void 0!==t&&t||"undefined"!=typeof self&&self||void 0!==n&&n,a="URLSearchParams"in n,r="Symbol"in n&&"iterator"in Symbol,s="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in n,o="ArrayBuffer"in n;if(o)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var n={next:function(){var n=e.shift();return{done:void 0===n,value:n}}};return r&&(n[Symbol.iterator]=function(){return n}),n}function y(e){this.map={},e instanceof y?e.forEach((function(e,n){this.append(n,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(n){this.append(n,e[n])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(n,t){e.onload=function(){n(e.result)},e.onerror=function(){t(e.error)}}))}function f(e){var n=new FileReader,t=m(n);return n.readAsArrayBuffer(e),t}function g(e){if(e.slice)return e.slice(0);var n=new Uint8Array(e.byteLength);return n.set(new Uint8Array(e)),n.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(e){var n;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:a&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():o&&s&&(n=e)&&DataView.prototype.isPrototypeOf(n)?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(f)}),this.text=function(){var e,n,t,a=h(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,t=m(n=new FileReader),n.readAsText(e),t;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var n=new Uint8Array(e),t=new Array(n.length),a=0;a<n.length;a++)t[a]=String.fromCharCode(n[a]);return t.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}y.prototype.append=function(e,n){e=d(e),n=u(n);var t=this.map[e];this.map[e]=t?t+", "+n:n},y.prototype.delete=function(e){delete this.map[d(e)]},y.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},y.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},y.prototype.set=function(e,n){this.map[d(e)]=u(n)},y.prototype.forEach=function(e,n){for(var t in this.map)this.map.hasOwnProperty(t)&&e.call(n,this.map[t],t,this)},y.prototype.keys=function(){var e=[];return this.forEach((function(n,t){e.push(t)})),p(e)},y.prototype.values=function(){var e=[];return this.forEach((function(n){e.push(n)})),p(e)},y.prototype.entries=function(){var e=[];return this.forEach((function(n,t){e.push([t,n])})),p(e)},r&&(y.prototype[Symbol.iterator]=y.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(e,n){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var t,a,r=(n=n||{}).body;if(e instanceof k){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,n.headers||(this.headers=new y(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new y(n.headers)),this.method=(a=(t=n.method||this.method||"GET").toUpperCase(),w.indexOf(a)>-1?a:t),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==n.cache&&"no-cache"!==n.cache)){var s=/([?&])_=[^&]*/;s.test(this.url)?this.url=this.url.replace(s,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function b(e){var n=new FormData;return e.trim().split("&").forEach((function(e){if(e){var t=e.split("="),a=t.shift().replace(/\+/g," "),r=t.join("=").replace(/\+/g," ");n.append(decodeURIComponent(a),decodeURIComponent(r))}})),n}function v(e,n){if(!(this instanceof v))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');n||(n={}),this.type="default",this.status=void 0===n.status?200:n.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===n.statusText?"":""+n.statusText,this.headers=new y(n.headers),this.url=n.url||"",this._initBody(e)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})},_.call(k.prototype),_.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new y(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];v.redirect=function(e,n){if(-1===E.indexOf(n))throw new RangeError("Invalid status code");return new v(null,{status:n,headers:{location:e}})},e.DOMException=n.DOMException;try{new e.DOMException}catch(n){e.DOMException=function(e,n){this.message=e,this.name=n;var t=Error(e);this.stack=t.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function T(t,a){return new Promise((function(r,i){var c=new k(t,a);if(c.signal&&c.signal.aborted)return i(new e.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function d(){l.abort()}l.onload=function(){var e,n,t={status:l.status,statusText:l.statusText,headers:(e=l.getAllResponseHeaders()||"",n=new y,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var t=e.split(":"),a=t.shift().trim();if(a){var r=t.join(":").trim();n.append(a,r)}})),n)};t.url="responseURL"in l?l.responseURL:t.headers.get("X-Request-URL");var a="response"in l?l.response:l.responseText;setTimeout((function(){r(new v(a,t))}),0)},l.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},l.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},l.onabort=function(){setTimeout((function(){i(new e.DOMException("Aborted","AbortError"))}),0)},l.open(c.method,function(e){try{return""===e&&n.location.href?n.location.href:e}catch(n){return e}}(c.url),!0),"include"===c.credentials?l.withCredentials=!0:"omit"===c.credentials&&(l.withCredentials=!1),"responseType"in l&&(s?l.responseType="blob":o&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(l.responseType="arraybuffer")),!a||"object"!=typeof a.headers||a.headers instanceof y?c.headers.forEach((function(e,n){l.setRequestHeader(n,e)})):Object.getOwnPropertyNames(a.headers).forEach((function(e){l.setRequestHeader(e,u(a.headers[e]))})),c.signal&&(c.signal.addEventListener("abort",d),l.onreadystatechange=function(){4===l.readyState&&c.signal.removeEventListener("abort",d)}),l.send(void 0===c._bodyInit?null:c._bodyInit)}))}T.polyfill=!0,n.fetch||(n.fetch=T,n.Headers=y,n.Request=k,n.Response=v),e.Headers=y,e.Request=k,e.Response=v,e.fetch=T}({}),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=a.fetch?a:r;(e=s.fetch).default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,n.exports=e}},function(){return n||(0,e[s(e)[0]])((n={exports:{}}).exports,n),n.exports}),f={};c(f,{Answer:()=>xn,BaseMessage:()=>In,Client:()=>Zn,EmailRegex:()=>Ce,EmailRegexMatch:()=>Ie,FeedbackFocusKind:()=>Je,FeedbackKeyRegex:()=>me,FeedbackKeyRegexMatch:()=>fe,FeedbackSort:()=>ze,FeedbackType:()=>Ye,FeedbackTypename:()=>Ze,GoogleIDRegex:()=>ve,GoogleIDRegexMatch:()=>Ee,KaidRegex:()=>K,KaidRegexMatch:()=>B,ListProgramSortOrder:()=>Xe,MESSAGE_ENCRYPTED_KEY_LENGTHS:()=>_e,MESSAGE_KEY_LENGTHS:()=>he,Message:()=>$n,MessageEncryptedKeyRegex:()=>we,MessageEncryptedKeyRegexMatch:()=>ke,MessageType:()=>Nn,PROGRAM_ID_LENGTHS:()=>H,PROGRAM_KEY_LENGTHS:()=>te,PROGRAM_URL_PATHS:()=>Y,Program:()=>fn,ProgramEditorType:()=>We,ProgramIDRegex:()=>G,ProgramIDRegexMatch:()=>W,ProgramImagePathRegex:()=>ee,ProgramImagePathRegexMatch:()=>ne,ProgramKeyRegex:()=>ae,ProgramKeyRegexMatch:()=>re,ProgramType:()=>hn,ProgramURLRegex:()=>Z,ProgramURLRegexMatch:()=>z,QualarooIDRegex:()=>Se,QualarooIDRegexMatch:()=>Ae,Question:()=>Un,Reply:()=>On,ServiceErrorCode:()=>Qe,ServiceErrorName:()=>He,TipsAndThanks:()=>Dn,TypeToMessageClass:()=>Jn,URL_LOCALES:()=>M,URL_TLDS:()=>q,User:()=>en,UserAccessLevel:()=>Ge,UserURLRegex:()=>j,UserURLRegexMatch:()=>V,assertDataResponse:()=>rn,avatarNameToSlug:()=>wn,avatarNames:()=>gn,avatarSlugToName:()=>kn,avatarSlugs:()=>_n,convertAvatarPNGToSVG:()=>Sn,convertAvatarSVGToPNG:()=>Tn,extractAvatarSlug:()=>En,generateAvatarPNG:()=>vn,generateAvatarSVG:()=>bn,getLatestFragment:()=>C,getLatestMutation:()=>P,getLatestQuery:()=>A,isAnswerSchema:()=>Kn,isDataResponse:()=>nn,isEmail:()=>Ne,isEncryptedFeedbackKey:()=>be,isFeedbackKey:()=>ge,isGoogleID:()=>Te,isInputErrorResponse:()=>an,isKaid:()=>F,isProgramID:()=>J,isProgramKey:()=>se,isProgramURL:()=>X,isQualarooID:()=>Pe,isQuestionSchema:()=>Mn,isReplySchema:()=>qn,isServiceErrorsResponse:()=>tn,isTipsAndThanksSchema:()=>Ln,isUserURL:()=>Q,mutations:()=>Ke,programIDtoKey:()=>on,programKeyToID:()=>sn,queries:()=>g,resolveFeedbackKey:()=>un,resolveKaid:()=>cn,resolveProgramID:()=>dn,resolveUsername:()=>ln});var g={};c(g,{AvatarDataForProfile:()=>_,FeedbackQuery:()=>w,GetFeedbackReplies:()=>k,GetFeedbackRepliesPage:()=>b,GetFullUserProfile:()=>ie,GetProfileWidgets:()=>oe,GetUserByUsernameOrEmail:()=>ce,GetUserHoverCardProfile:()=>le,Hotlist:()=>de,ProgramQuery:()=>ue,ProjectsAuthoredByUser:()=>pe,QAExpandKeyInfo:()=>qe,QaExpandKeyInfo:()=>ye,avatarDataForProfile:()=>$,feedbackQuery:()=>x,getFeedbackReplies:()=>U,getFeedbackRepliesPage:()=>O,getFullUserProfile:()=>Re,getProfileWidgets:()=>$e,getUserByUsernameOrEmail:()=>xe,getUserHoverCardProfile:()=>Ue,hotlist:()=>Oe,programQuery:()=>De,projectsAuthoredByUser:()=>Le});var _,w,k,b,v="https://www.khanacademy.org/api/internal/graphql",E="https://cdn.jsdelivr.net/gh/bhavjitChauhan/khan-api@safelist",T=`bhavjitchauhan/khan-api_${Date.now()}`,S=((e,n,r)=>(r=null!=e?t(i(e)):{},l(a(r,"default",{value:e,enumerable:!0}),e)))(m());async function A(e){const n=await I(`${E}/query/${e}`);return 404===n.status?null:await n.text()}async function P(e){const n=await I(`${E}/mutation/${e}`);return 404===n.status?null:await n.text()}async function C(e){const n=await I(`${E}/fragment/${e}`);return 404===n.status?null:await n.text()}async function I(e,n){return await(0,S.default)(e,n)}async function N(e,n,t){return t={method:"post",body:JSON.stringify(n),...t},await I(e,t)}async function R(e,n,t={},a){const r={query:n,variables:t},s=await N(e,r,a);if(403===s.status&&(await s.text()).startsWith("routes._validatePermission: [unauthorized error] Operation not found in safelist")){const t=n.startsWith("query"),s=n.match(/^(?:query|mutation) (\w+)/)?.[1];if(!s)throw new Error("An unknown query is no longer in the safelist");console.warn(`The query for operation "${s}" is no longer in the safelist. Attempting to fetch the latest version from the safelist...`);const i=t?await A(s):await P(s);if(!i)throw new Error(`The query for operation "${s}" was not found in the safelist`);return await N(e,{...r,query:i},a)}return s}function $(e,n){return R(`${v}/avatarDataForProfile`,_.query,"string"==typeof e?{kaid:e}:e,n)}function x(e,n){return R(`${v}/feedbackQuery`,w.query,e,n)}function U(e,n){return R(`${v}/getFeedbackReplies`,k.query,"string"==typeof e?{postKey:e}:e,n)}function O(e,n){return R(`${v}/getFeedbackRepliesPage`,b.query,e,n)}function D(e){return e.replace(/-/g,"+").replace(/_/g,"/")}function L(e){return new RegExp(`(${e.source.slice(1,-1)})`)}(_||(_={})).query="query avatarDataForProfile($kaid: String!) {\n  user(kaid: $kaid) {\n    id\n    avatar {\n      name\n      imageSrc\n      __typename\n    }\n    __typename\n  }\n}\n",(w||(w={})).query="query feedbackQuery($topicId: String!, $focusKind: String!, $cursor: String, $limit: Int, $feedbackType: FeedbackType!, $currentSort: Int, $qaExpandKey: String) {\n  feedback(focusId: $topicId, cursor: $cursor, limit: $limit, feedbackType: $feedbackType, focusKind: $focusKind, sort: $currentSort, qaExpandKey: $qaExpandKey, answersLimit: 1) {\n    feedback {\n      isLocked\n      isPinned\n      replyCount\n      appearsAsDeleted\n      author {\n        id\n        kaid\n        nickname\n        avatar {\n          name\n          imageSrc\n          __typename\n        }\n        __typename\n      }\n      badges {\n        name\n        icons {\n          smallUrl\n          __typename\n        }\n        description\n        __typename\n      }\n      content\n      date\n      definitelyNotSpam\n      deleted\n      downVoted\n      expandKey\n      feedbackType\n      flaggedBy\n      flaggedByUser\n      flags\n      focusUrl\n      focus {\n        kind\n        id\n        translatedTitle\n        relativeUrl\n        __typename\n      }\n      fromVideoAuthor\n      key\n      lowQualityScore\n      notifyOnAnswer\n      permalink\n      qualityKind\n      replyCount\n      replyExpandKeys\n      showLowQualityNotice\n      sumVotesIncremented\n      upVoted\n      ... on QuestionFeedback {\n        hasAnswered\n        answers {\n          isLocked\n          isPinned\n          replyCount\n          appearsAsDeleted\n          author {\n            id\n            kaid\n            nickname\n            avatar {\n              name\n              imageSrc\n              __typename\n            }\n            __typename\n          }\n          badges {\n            name\n            icons {\n              smallUrl\n              __typename\n            }\n            description\n            __typename\n          }\n          content\n          date\n          definitelyNotSpam\n          deleted\n          downVoted\n          expandKey\n          feedbackType\n          flaggedBy\n          flaggedByUser\n          flags\n          focusUrl\n          focus {\n            kind\n            id\n            translatedTitle\n            relativeUrl\n            __typename\n          }\n          fromVideoAuthor\n          key\n          lowQualityScore\n          notifyOnAnswer\n          permalink\n          qualityKind\n          replyCount\n          replyExpandKeys\n          showLowQualityNotice\n          sumVotesIncremented\n          upVoted\n          __typename\n        }\n        isOld\n        answerCount\n        __typename\n      }\n      ... on AnswerFeedback {\n        question {\n          isLocked\n          isPinned\n          replyCount\n          appearsAsDeleted\n          author {\n            id\n            kaid\n            nickname\n            avatar {\n              name\n              imageSrc\n              __typename\n            }\n            __typename\n          }\n          badges {\n            name\n            icons {\n              smallUrl\n              __typename\n            }\n            description\n            __typename\n          }\n          content\n          date\n          definitelyNotSpam\n          deleted\n          downVoted\n          expandKey\n          feedbackType\n          flaggedBy\n          flaggedByUser\n          flags\n          focusUrl\n          focus {\n            kind\n            id\n            translatedTitle\n            relativeUrl\n            __typename\n          }\n          fromVideoAuthor\n          key\n          lowQualityScore\n          notifyOnAnswer\n          permalink\n          qualityKind\n          replyCount\n          replyExpandKeys\n          showLowQualityNotice\n          sumVotesIncremented\n          upVoted\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    cursor\n    isComplete\n    sortedByDate\n    __typename\n  }\n}\n",(k||(k={})).query="query getFeedbackReplies($postKey: String!) {\n  feedbackReplies(feedbackKey: $postKey) {\n    isLocked\n    isPinned\n    expandKey\n    appearsAsDeleted\n    author {\n      id\n      kaid\n      nickname\n      avatar {\n        name\n        imageSrc\n        __typename\n      }\n      __typename\n    }\n    content\n    date\n    definitelyNotSpam\n    deleted\n    downVoted\n    expandKey\n    feedbackType\n    flaggedBy\n    flaggedByUser\n    flags\n    focusUrl\n    fromVideoAuthor\n    key\n    lowQualityScore\n    notifyOnAnswer\n    permalink\n    qualityKind\n    replyCount\n    replyExpandKeys\n    showLowQualityNotice\n    sumVotesIncremented\n    upVoted\n    __typename\n  }\n}\n",(b||(b={})).query="query getFeedbackRepliesPage($postKey: String!, $cursor: String, $limit: Int!) {\n  feedbackRepliesPaginated(feedbackKey: $postKey, cursor: $cursor, limit: $limit) {\n    cursor\n    isComplete\n    feedback {\n      isLocked\n      isPinned\n      expandKey\n      appearsAsDeleted\n      author {\n        id\n        kaid\n        nickname\n        avatar {\n          name\n          imageSrc\n          __typename\n        }\n        __typename\n      }\n      content\n      date\n      definitelyNotSpam\n      deleted\n      downVoted\n      expandKey\n      feedbackType\n      flaggedBy\n      flaggedByUser\n      flags\n      focusUrl\n      fromVideoAuthor\n      key\n      lowQualityScore\n      notifyOnAnswer\n      permalink\n      qualityKind\n      replyCount\n      replyExpandKeys\n      showLowQualityNotice\n      sumVotesIncremented\n      upVoted\n      __typename\n    }\n    __typename\n  }\n}\n";var q=["com","org"],M=["as","az","cs","da","el","gu","hu","id","it","lt","ja","kk","kn","ky","lv","mn","mr","my","nl","pt-pt","ru","sv","ta","uz","bg","bn","de","en","es","fr","hi","hy","ka","km","ko","nb","pa","pl","pt","ro","sr","tr","vi","zh-hans","sgn-us"],K=/^kaid_\d{20,25}$/,B=L(K),F=e=>K.test(e),j=new RegExp(`^https?:\\/\\/(?:(?:www|${M.join("|")})\\.)?khanacademy\\.(?:${q.join("|")})\\/profile\\/((?!kaid_|kaid_\\D)\\w+|(?:${K.toString().slice(2,-2)}))(?:\\/.*)?$`,"i"),V=L(j),Q=e=>j.test(e),H=[9,10,16],G=new RegExp(`^[1-9](?:(?:${H.map((e=>`\\d{${e-1}}`)).join("|")}))$`),W=new RegExp(`(?:^|\\D)(${G.source.slice(1,-1)})(?:$|\\D)`);function J(e){return G.test(e.toString())}var Y=["computer-programming","cs","pixar","nasa","piab-sandbox","computer-science","hour-of-code","math","differential-equations","electrical-engineering","mcat","apchem-topic","chemistry","art-history-basics","biology"],Z=new RegExp(`^https?:\\/\\/(?:(?:www|${M.join("|")})\\.)?khanacademy\\.(?:${q.join("|")})\\/(?:${Y.join("|")})\\/[\\w\\d-.~()'!*:@,;]+\\/(${G.toString().slice(2,-2)})$`,"i"),z=L(Z);function X(e){return Z.test(e)}var ee=new RegExp(`^\\/(?:${Y.join("|")})\\/[\\w\\d-.~()'!*:@,;]+\\/\\d+\\/(\\d+)\\.png$`),ne=L(ee),te=[51,54],ae=/^ag5zfmtoYW4tYWNhZGVteXI(?:U|X)CxIKU2NyYXRjaHBhZB(?:i|j)(?=[\w-]*$)(?:.{7}w|.{9}C(?:g|w|A|Q)w)$/,re=L(ae);function se(e){if(te.includes(e.length))return!1;if(!ae.test(e))return!1;try{return atob(D(e)),!0}catch{return!1}}var ie,oe,ce,le,de,ue,pe,ye,he=[106,107,108,110,111],me=/^ag5zfmtoYW4tYWNhZGVteX(?:I|J)(?:A|B|7|9|-|_)CxIIVXNlckRhdGEi(?:Gm|GG|G2|Hm|HG|HW)thaWRf(?:M|N|O)(?:\w{34}|\w{29,31}|\w{27})(?:LEghGZWVkYmFjaxiAg[I-P](?:O|P|W|X|2|3)|DAsSCEZlZWRiYWNrGICA|MCxIIRmVlZGJhY2sYgI(?:C|D)|wLEghGZWVkYmFjaxiAg|DAsSCEZlZWRiYWNrGICA)(?:[\w-]{5}|[\w-]{7,8})(?:M|DA|C(?:g|w|A|Q)w)$/,fe=L(me),ge=e=>me.test(e),_e=[301],we=/^kaencrypted_[a-z0-9]{32}_[a-z0-9]{256}$/,ke=L(we),be=e=>we.test(e),ve=/^http:\/\/googleid\.khanacademy\.org\/(\d+)$/,Ee=L(ve),Te=e=>ve.test(e),Se=/^_gae_bingo_random:(\w+-\w+-\w+)$/,Ae=L(Se),Pe=e=>Se.test(e),Ce=/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,Ie=L(Ce),Ne=e=>Ce.test(e);function Re(e,n){return R(`${v}/getFullUserProfile`,ie.query,"string"==typeof e?F(e)?{kaid:e}:{username:e}:e,n)}function $e(e,n){return R(`${v}/getProfileWidgets`,oe.query,"string"==typeof e&&F(e)?{kaid:e}:e,n)}function xe(e,n){return R(`${v}/getUserByUsernameOrEmail`,ce.query,"string"==typeof e?Ne(e)?{email:e}:{username:e}:e,n)}function Ue(e,n){return R(`${v}/getUserHoverCardProfile`,le.query,"string"==typeof e?{kaid:e}:e,n)}function Oe(e,n){return R(`${v}/hotlist`,de.query,e,n)}function De(e,n){return R(`${v}/programQuery`,ue.query,"number"==typeof e?{programId:e.toString()}:"string"==typeof e?{programId:e}:e,n)}function Le(e,n){return R(`${v}/projectsAuthoredByUser`,pe.query,e,n)}function qe(e,n){return R(`${v}/QAExpandKeyInfo`,ye.query,"string"==typeof e?{encryptedKey:e}:e,n)}(ie||(ie={})).query='query getFullUserProfile($kaid: String, $username: String) {\n  user(kaid: $kaid, username: $username) {\n    id\n    kaid\n    key\n    userId\n    email\n    username\n    profileRoot\n    gaUserId\n    isPhantom\n    isDeveloper: hasPermission(name: "can_do_what_only_admins_can_do")\n    isCurator: hasPermission(name: "can_curate_tags", scope: ANY_ON_CURRENT_LOCALE)\n    isCreator: hasPermission(name: "has_creator_role", scope: ANY_ON_CURRENT_LOCALE)\n    isPublisher: hasPermission(name: "can_publish", scope: ANY_ON_CURRENT_LOCALE)\n    isModerator: hasPermission(name: "can_moderate_users", scope: GLOBAL)\n    isParent\n    isTeacher\n    isFormalTeacher\n    isDataCollectible\n    isChild\n    isOrphan\n    isCoachingLoggedInUser\n    canModifyCoaches\n    nickname\n    hideVisual\n    joined\n    points\n    countVideosCompleted\n    bio\n    profile {\n      accessLevel\n      __typename\n    }\n    soundOn\n    muteVideos\n    showCaptions\n    prefersReducedMotion\n    noColorInVideos\n    newNotificationCount\n    canHellban: hasPermission(name: "can_ban_users", scope: GLOBAL)\n    canMessageUsers: hasPermission(name: "can_send_moderator_messages", scope: GLOBAL)\n    isSelf: isActor\n    hasStudents: hasCoachees\n    hasClasses\n    hasChildren\n    hasCoach\n    badgeCounts\n    homepageUrl\n    isMidsignupPhantom\n    includesDistrictOwnedData\n    includesKmapDistrictOwnedData\n    includesK4dDistrictOwnedData\n    canAccessDistrictsHomepage\n    preferredKaLocale {\n      id\n      kaLocale\n      status\n      __typename\n    }\n    underAgeGate {\n      parentEmail\n      daysUntilCutoff\n      approvalGivenAt\n      __typename\n    }\n    authEmails\n    signupDataIfUnverified {\n      email\n      emailBounced\n      __typename\n    }\n    pendingEmailVerifications {\n      email\n      __typename\n    }\n    hasAccessToAIGuideTeacher\n    tosAccepted\n    shouldShowAgeCheck\n    birthMonthYear\n    lastLoginCountry\n    __typename\n  }\n  actorIsImpersonatingUser\n  isAIGuideEnabled\n  hasAccessToAIGuideDev\n}\n',(oe||(oe={})).query="query getProfileWidgets($kaid: String!) {\n  user(kaid: $kaid) {\n    id\n    kaid\n    badgeCounts\n    isChild\n    profile {\n      programs {\n        id\n        authorKaid\n        authorNickname\n        deleted\n        displayableSpinoffCount\n        imagePath\n        key\n        sumVotesIncremented\n        translatedTitle: title\n        url\n        __typename\n      }\n      __typename\n    }\n    programs(sort: TOP, pageInfo: {itemsPerPage: 2}) {\n      programs {\n        id\n        authorKaid\n        authorNickname\n        deleted\n        displayableSpinoffCount\n        imagePath\n        key\n        sumVotesIncremented\n        translatedTitle: title\n        url\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  userSummary(kaid: $kaid) {\n    statistics {\n      answers\n      comments\n      flags\n      projectanswers\n      projectquestions\n      questions\n      replies\n      votes\n      __typename\n    }\n    __typename\n  }\n}\n",(ce||(ce={})).query="query getUserByUsernameOrEmail($username: String, $email: String) {\n  user(username: $username, email: $email) {\n    id\n    kaid\n    __typename\n  }\n}\n",(le||(le={})).query="query getUserHoverCardProfile($kaid: String!) {\n  user(kaid: $kaid) {\n    id\n    nickname\n    username\n    bio\n    avatar {\n      name\n      imageSrc\n      __typename\n    }\n    points\n    isPhantom\n    isActor\n    isCoachedByActor\n    userSummaryIsVisibleToActor\n    actorHasUserScopedPermission(capability: CAN_VIEW_USER_IDENTITY)\n    __typename\n  }\n}\n",(de||(de={})).query="query hotlist($curationNodeId: String, $onlyOfficialProjectSpinoffs: Boolean!, $sort: ListProgramSortOrder, $pageInfo: ListProgramsPageInfo) {\n  listTopPrograms(curationNodeId: $curationNodeId, onlyOfficialProjectSpinoffs: $onlyOfficialProjectSpinoffs, sort: $sort, pageInfo: $pageInfo) {\n    complete\n    cursor\n    programs {\n      id\n      key\n      authorKaid\n      authorNickname\n      displayableSpinoffCount\n      imagePath\n      sumVotesIncremented\n      translatedTitle: title\n      url\n      __typename\n    }\n    __typename\n  }\n}\n",(ue||(ue={})).query="query programQuery($programId: String!) {\n  programById(id: $programId) {\n    byChild\n    category\n    created\n    creatorProfile: author {\n      id\n      nickname\n      profileRoot\n      profile {\n        accessLevel\n        __typename\n      }\n      __typename\n    }\n    deleted\n    description\n    spinoffCount: displayableSpinoffCount\n    docsUrlPath\n    flags\n    flaggedBy: flaggedByKaids\n    flaggedByUser: isFlaggedByCurrentUser\n    height\n    hideFromHotlist\n    id\n    imagePath\n    isProjectOrFork: originIsProject\n    isOwner\n    kaid: authorKaid\n    key\n    newUrlPath\n    originScratchpad: originProgram {\n      deleted\n      translatedTitle\n      url\n      __typename\n    }\n    restrictPosting\n    revision: latestRevision {\n      id\n      code\n      configVersion\n      created\n      editorType\n      folds\n      __typename\n    }\n    slug\n    sumVotesIncremented\n    title\n    topic: parentCurationNode {\n      id\n      nodeSlug: slug\n      relativeUrl\n      slug\n      translatedTitle\n      __typename\n    }\n    translatedTitle\n    url\n    userAuthoredContentType\n    upVoted\n    width\n    __typename\n  }\n}\n",(pe||(pe={})).query="query projectsAuthoredByUser($kaid: String, $pageInfo: ListProgramsPageInfo, $sort: ListProgramSortOrder) {\n  user(kaid: $kaid) {\n    id\n    programs(pageInfo: $pageInfo, sort: $sort) {\n      complete\n      cursor\n      programs {\n        id\n        key\n        authorKaid\n        authorNickname\n        displayableSpinoffCount\n        imagePath\n        sumVotesIncremented\n        translatedTitle: title\n        url\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n",(ye||(ye={})).query="query QAExpandKeyInfo($encryptedKey: String) {\n  qaExpandKeyInfo(encryptedQaExpandKey: $encryptedKey) {\n    feedbackType\n    unencryptedKey\n    __typename\n  }\n}\n";var Me,Ke={};function Be(e,n){return R(`${v}/loginWithPasswordMutation`,Me.query,e,{headers:{"x-ka-fkey":T,Cookie:`fkey=${T}`},...n})}c(Ke,{LoginWithPasswordMutation:()=>Me,loginWithPasswordMutation:()=>Be}),(e=>{let n;var t;e.query="mutation loginWithPasswordMutation($identifier: String!, $password: String!) {\n  loginWithPassword(identifier: $identifier, password: $password) {\n    user {\n      id\n      kaid\n      canAccessDistrictsHomepage\n      isTeacher\n      hasUnresolvedInvitations\n      transferAuthToken\n      preferredKaLocale {\n        id\n        kaLocale\n        status\n        __typename\n      }\n      __typename\n    }\n    isFirstLogin\n    error {\n      code\n      __typename\n    }\n    __typename\n  }\n}\n",(t=n=e.ErrorCode||(e.ErrorCode={})).INVALID_CREDENTIALS="INVALID_CREDENTIALS",t.TOO_MANY_ATTEMPTS="TOO_MANY_ATTEMPTS"})(Me||(Me={}));var Fe,je,Ve=class{constructor(e,n){return e instanceof Zn?this.client=e:n??(n=e),n&&this.copy(n),this}copy(e){return Object.assign(this,e),this}copyFromSchema(e){return this.rawData={...this.rawData,...e},this.copy(this.transformSchema(e))}isSchema(e){return this.is(this.transformSchema(e))}},Qe=(e=>(e.DOWNSTREAM_SERVICE_ERROR="DOWNSTREAM_SERVICE_ERROR",e))(Qe||{}),He=(e=>(e.users="users",e))(He||{}),Ge=(e=>(e.COACH="COACH",e.PUBLIC="PUBLIC",e))(Ge||{}),We=(e=>(e.pjs="pjs",e.webpage="webpage",e.ace_sql="ace_sql",e.unknown="",e))(We||{}),Je=(e=>(e.Challenge="Challenge",e.Interactive="Interactive",e.Project="Project",e.Scratchpad="Scratchpad",e.Talkthrough="Talkthrough",e))(Je||{}),Ye=(e=>(e.ALL_PROJECT_ANSWER="ALL_PROJECT_ANSWER",e.ALL_PROJECT_QUESTION="ALL_PROJECT_QUESTION",e.ANSWER="ANSWER",e.COMMENT="COMMENT",e.PROGRAM="PROGRAM",e.PROJECTFEEDBACK="PROJECTFEEDBACK",e.PROJECT_CRITIQUE_ANSWER="PROJECT_CRITIQUE_ANSWER",e.PROJECT_CRITIQUE_QUESTION="PROJECT_CRITIQUE_QUESTION",e.PROJECT_EVAL_ANSWER="PROJECT_EVAL_ANSWER",e.PROJECT_EVAL_QUESTION="PROJECT_EVAL_QUESTION",e.PROJECT_HELP_ANSWER="PROJECT_HELP_ANSWER",e.PROJECT_HELP_QUESTION="PROJECT_HELP_QUESTION",e.QUESTION="QUESTION",e.REPLY="REPLY",e.SUGGESTED_CLARIFICATION="SUGGESTED_CLARIFICATION",e))(Ye||{}),Ze=(e=>(e.AnswerFeedback="AnswerFeedback",e.BasicFeedback="BasicFeedback",e.LowQualityFeedback="LowQualityFeedback",e.QuestionFeedback="QuestionFeedback",e))(Ze||{}),ze=(e=>(e[e.TopVoted=1]="TopVoted",e[e.Recent=2]="Recent",e[e.Trending=5]="Trending",e))(ze||{}),Xe=(e=>(e.TOP="TOP",e.RECENT="RECENT",e.HOT="HOT",e.OFFICIAL="OFFICIAL",e.UPVOTE="UPVOTE",e.OLDEST="OLDEST",e))(Xe||{});Fe=new WeakSet,je=function(){if(this.kaid)return this.kaid;if(this.username)return this.username;if(this.email)return this.email;throw new Error("User has no identifier")};var en=class e extends Ve{constructor(){super(...arguments),p(this,Fe)}get url(){return this.kaid?`https://www.khanacademy.org/profile/${this.username??this.kaid}`:null}static fromSchema(n){const t=new e;return t.copyFromSchema(n),t.rawData=n,t}static fromIdentifier(n){return new e({kaid:F(n)?n:void 0,username:F(n)||Ne(n)?void 0:n,email:Ne(n)?n:void 0})}transformSchema(e){return{emails:e.authEmails??void 0,badgeCounts:e.badgeCounts?JSON.parse(e.badgeCounts):void 0,bio:e.bio??void 0,canAccessDistrictsHomepage:e.canAccessDistrictsHomepage??void 0,canHellban:e.canHellban??void 0,canMessageUsers:e.canMessageUsers??void 0,canModifyCoaches:e.canModifyCoaches??void 0,completedVideos:e.countVideosCompleted,email:e.email??void 0,hasAccessToAIGuideDev:e.hasAccessToAIGuideDev??void 0,hasAccessToAIGuideTeacher:e.hasAccessToAIGuideTeacher??void 0,hasChildren:e.hasChildren??void 0,hasClasses:e.hasClasses??void 0,hasCoach:e.hasCoach??void 0,hasStudents:e.hasStudents??void 0,child:e.isChild??void 0,creator:e.isCreator??void 0,curator:e.isCurator??void 0,developer:e.isDeveloper??void 0,midsignupPhantom:e.isMidsignupPhantom??void 0,moderator:e.isModerator??void 0,orphan:e.isOrphan??void 0,parent:e.isParent??void 0,phantom:e.isPhantom??void 0,publisher:e.isPublisher??void 0,self:e.isSelf??void 0,teacher:e.isTeacher??void 0,formalTeacher:e.isFormalTeacher??void 0,joined:e.joined?new Date(e.joined):void 0,kaid:"string"==typeof e.kaid&&F(e.kaid)?e.kaid:"string"==typeof e.kaid?null:void 0,key:e.key??void 0,newNotifications:e.newNotificationCount??void 0,nickname:e.nickname??void 0,points:e.points??void 0,accessLevel:e.profile?.accessLevel,googleID:"string"==typeof e.userId&&Te(e.userId)?e.userId.match(ve)[1]:"string"==typeof e.userId?null:void 0,qualarooID:"string"==typeof e.qualarooId&&Pe(e.qualarooId)?e.qualarooId.match(Se)[1]:"string"==typeof e.qualarooId?null:void 0,username:e.username??(e.profileRoot?F(e.profileRoot.slice(9,-1))?null:e.profileRoot.slice(9,-1):e.username)}}async get(e=this.client??new Zn){const n=await e.getUser(h(this,Fe,je).call(this));return this.copy(n)}async getAvatar(e=this.client??new Zn){const n=await e.getUserAvatar(h(this,Fe,je).call(this));return this.copy({avatar:n}),n}async getStatistics(e=this.client??new Zn){const n=await e.getUserStatistics(h(this,Fe,je).call(this));return this.copy({statistics:n})}async*getPrograms(e=this.client??new Zn,n,t){for await(const a of e.getUserPrograms(h(this,Fe,je).call(this),n,t))this.programs||this.copy({programs:[]}),this.programs?.push(...a),yield a;return this}async getAllPrograms(e=this.client??new Zn,n,t){const a=await e.getAllUserPrograms(h(this,Fe,je).call(this),n,t);return this.copy({programs:a})}is(e){return this.kaid&&e.kaid||this.email&&e.email||this.key&&e.key||this.username&&e.username||this.googleID&&e.googleID||this.qualarooID&&e.qualarooID?this.kaid&&e.kaid&&this.kaid===e.kaid||this.email&&e.email&&this.email===e.email||this.key&&e.key&&this.key===e.key||this.username&&e.username&&this.username===e.username||this.googleID&&e.googleID&&this.googleID===e.googleID||this.qualarooID&&e.qualarooID&&this.qualarooID===e.qualarooID||!1:(console.warn("Users don't have any identifiers that can be compared"),!1)}};function nn(e){return"data"in e&&!("errors"in e)}function tn(e){return"errors"in e&&Array.isArray(e.errors)&&"data"in e}function an(e){return"errors"in e&&Array.isArray(e.errors)&&!("data"in e)}function rn(e){if(tn(e))throw new Error("Expected data response but got service errors response: "+e.errors.map((e=>e.message)).join(", "));if(an(e))throw new Error("Expected data response but got input errors response: "+e.errors.map((e=>e.message)).join(", "));if(!nn(e))throw new Error("Expected data response but got unknown response")}function sn(e){if(!se(e))throw new Error("Invalid program key");let n=atob(D(e)).split("").map((e=>e.charCodeAt(0)));const t=n[17];if(20===t)n=n.slice(32,37);else{if(23!==t)throw new Error(`Unknown program key version: ${t}`);n=n.slice(34,40)}let a=0n;for(let e=0;e<n.length;e++)a|=BigInt(127&n[e])<<BigInt(7*e);return Number(20===t?a:a<<14n)}function on(e){if(!J(e))throw new Error("Invalid program ID");"string"==typeof e&&(e=parseInt(e));const n=e.toString(2).match(/.{1,7}(?=(.{7})*$)/g).map((e=>String.fromCharCode(parseInt(7===e.length?`1${e}`:e,2)))).reverse().join("");let t=btoa(`js~khan-academyr${5===n.length?"":""}\v\nScratchpad${n}\f`);return t=function(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}(t),t}async function cn(e){if(F(e))return e;if(F(`kaid_${e}`))return`kaid_${e}`;if(Q(e)){const n=e.match(j);if(!n)throw new Error("Invalid user URL");if(e=n[1],F(e))return e}const n=await xe(e),t=await n.json();if(rn(t),!t.data.user)throw new Error("User not found");const a=t.data.user.kaid;if(!F(a))throw new Error("Invalid KAID");return a}async function ln(e){if(!F(e)&&!Ne(e)&&!Q(e))return e;if(Q(e)){const n=e.match(j);if(!n)throw new Error("Invalid user URL");if(e=n[1],!F(e)&&!Ne(e))return e}F(e)||(e=await cn(e));const n=await Ue(e),t=await n.json();if(rn(t),!t.data.user)throw new Error("User not found");return t.data.user.username}function dn(e){if("number"==typeof e){if(!J(e))throw new Error("Invalid program ID");return e}if(X(e)){const n=e.match(Z)[1];if(!J(n))throw new Error("Invalid program URL");return parseInt(n,10)}if(se(e)){if(!J(e=sn(e)))throw new Error("Invalid program key");return e}if("string"==typeof e){if(!J(e))throw new Error("Invalid program ID");return parseInt(e,10)}throw new Error("Invalid program identifier")}async function un(e){if(ge(e))return e;if(!be(e))throw new Error("Invalid encrypted message key");const n=await qe(e),t=await n.json();if(rn(t),!t.data.qaExpandKeyInfo)throw new Error("Message key not found");return t.data.qaExpandKeyInfo.unencryptedKey}var pn,yn,hn=(e=>(e.ProcessingJS="pjs",e.HTML="webpage",e.SQL="ace_sql",e.Other="",e))(hn||{}),mn=class e extends Ve{constructor(){super(...arguments),p(this,pn)}get spinoff(){return void 0!==this.origin?!!this.origin:null}get lines(){return this.code?this.code.split("\n").length:null}get url(){return this.rawData?.url?`https://www.khanacademy.org${this.rawData.url}`:this.id?`https://www.khanacademy.org/computer-programming/-/${this.id}`:null}get shortUrl(){return this.id?`https://khanacademy.org/cs/-/${this.id}`:null}get thumbnailUrl(){return this.rawData?.imagePath?`https://www.khanacademy.org${this.rawData.imagePath}`:this.thumbnailID&&this.url?`${this.url}/${this.thumbnailID}.png`:null}static fromSchema(n){const t=new e;return t.copyFromSchema(n),t.rawData=n,t}static fromIdentifier(n){const t=dn(n);return new e({id:t,key:"string"==typeof n&&se(n)?n:void 0})}transformSchema(n){return{id:n.id?parseInt(n.id,10):void 0,title:n.translatedTitle,author:n.authorKaid||n.authorNickname||n.creatorProfile?en.fromSchema({kaid:n.authorKaid,nickname:n.authorNickname,isChild:n.byChild??void 0,...n.creatorProfile}):void 0,created:(()=>{if(n.created)return n.revision?.created?new Date(Math.min(new Date(n.created).valueOf(),new Date(n.revision.created).valueOf())):new Date(n.created)})(),updated:(()=>{if(n.revision?.created)return n.created&&n.revision.created===n.created?null:new Date(n.revision.created)})(),width:n.width,height:n.height,votes:n.sumVotesIncremented,spinOffCount:n.spinoffCount??n.displayableSpinoffCount,code:n.revision?.code,hidden:n.hideFromHotlist,type:(()=>{switch(n.revision?.editorType){case"pjs":return e.Type.ProcessingJS;case"webpage":return e.Type.HTML;case"ace_sql":return e.Type.SQL;default:return e.Type.Other}})(),origin:(()=>{if(!n.originScratchpad)return n.originScratchpad;const t=("https://khanacademy.org"+n.originScratchpad.url).match(Z)?.[1];if(t)return new e({id:parseInt(t,10),title:n.originScratchpad.translatedTitle,deleted:n.originScratchpad.deleted});console.error(`Failed to parse origin program ID from URL: ${n.originScratchpad.url}`)})(),key:n.key,thumbnailID:n.imagePath&&ee.test(n.imagePath)?parseInt(n.imagePath.match(ee)[1],10):void 0,description:"string"==typeof n.description?""!==n.description?n.description:null:n.description,deleted:n.deleted??void 0,selfFlagged:n.flaggedByUser,selfVoted:n.upVoted}}async get(e=this.client??new Zn){if(!this.id&&!this.key)throw new Error("Program is missing ID and key");const n=await e.getProgram(this.id??this.key);return this.copy(n)}async*getTipsAndThanks(e=this.client??new Zn,n){for await(const t of e.getProgramTipsAndThanks(h(this,pn,yn).call(this),n))this.tipsAndThanks||this.copy({tipsAndThanks:[]}),t.forEach((e=>this.tipsAndThanks?.push(e))),yield t;return this}async getAllTipsAndThanks(e=this.client??new Zn,n){const t=await e.getAllProgramTipsAndThanks(h(this,pn,yn).call(this),n);return this.copy({tipsAndThanks:t})}async*getQuestions(e=this.client??new Zn,n){for await(const t of e.getProgramQuestions(h(this,pn,yn).call(this),n))this.questions||this.copy({questions:[]}),t.forEach((e=>this.questions.push(e))),yield t;return this}async getAllQuestions(e=this.client??new Zn,n){const t=await e.getAllProgramQuestions(h(this,pn,yn).call(this),n);return this.copy({questions:t})}async*getHelpRequests(e=this.client??new Zn,n){for await(const t of e.getProgramHelpRequests(h(this,pn,yn).call(this),n))this.helpRequests||this.copy({helpRequests:[]}),t.forEach((e=>this.helpRequests.push(e))),yield t;return this}async getAllHelpRequests(e=this.client??new Zn,n){const t=await e.getAllProgramHelpRequests(h(this,pn,yn).call(this),n);return this.copy({helpRequests:t})}is(e){return this.id&&e.id||this.key&&e.key?this.id&&e.id&&this.id===e.id||this.key&&e.key&&this.key===e.key||!1:(console.warn("Programs don't have any identifiers that can be compared"),!1)}};pn=new WeakSet,yn=function(){if(this.id)return this.id;if(this.key)return this.key;throw new Error("Program has no identifier")},mn.Type=hn;var fn=mn,gn=["blobby_green_style","blobby_yellow_style","blobby_blue_style","blobby_purple_style","area_52_yellow_style","area_52_blue_style","area_52_green_style","area_52_purple_style","eggleston_blue_style","eggleston_yellow_style","eggleston_green_style","eggleston_orange_style","scuttlebug_purple_style","scuttlebug_yellow_style","scuttlebug_blue_style","scuttlebug_green_style","boggle_yellow_style","boggle_blue_style","boggle_green_style","boggle_purple_style","sneak_peak_green_style","sneak_peak_yellow_style","sneak_peak_blue_style","sneak_peak_purple_style","stelly_blue_style","stelly_yellow_style","stelly_green_style","stelly_orange_style","cacteye_purple_style","cacteye_yellow_style","cacteye_blue_style","cacteye_green_style","leaf_green_style","leaf_blue_style","leaf_grey_style","leaf_red_style","leaf_orange_style","leaf_yellow_style","leafers_seed_style","leafers_seedling_style","leafers_sapling_style","leafers_tree_style","leafers_ultimate_style","piceratops_seed_style","piceratops_seedling_style","piceratops_sapling_style","piceratops_tree_style","piceratops_ultimate_style","duskpin_seed_style","duskpin_seedling_style","duskpin_sapling_style","duskpin_tree_style","duskpin_ultimate_style","primosaur_seed_style","primosaur_seedling_style","primosaur_sapling_style","primosaur_tree_style","primosaur_ultimate_style","starky_seed_style","starky_seedling_style","starky_sapling_style","starky_tree_style","starky_ultimate_style","aqualine_seed_style","aqualine_seedling_style","aqualine_sapling_style","aqualine_tree_style","aqualine_ultimate_style","spunky_sam_blue_style","spunky_sam_green_style","spunky_sam_orange_style","spunky_sam_red_style","marcimus_pink_style","marcimus_orange_style","marcimus_red_style","marcimus_purple_style","mr_pink_red_style","mr_pink_green_style","mr_pink_orange_style","female_robot_amelia_style","female_robot_ada_style","female_robot_grace_style","male_robot_johnny_style","male_robot_donald_style","male_robot_hal_style","orange_juice_squid_orange_style","purple_pi_purple_style","purple_pi_pink_style","purple_pi_teal_style","mr_pants_teal_style","mr_pants_green_style","mr_pants_orange_style","mr_pants_pink_style","mr_pants_purple_style","old_spice_man_green_style","old_spice_man_blue_style","winston_default_style","winston_baby_style","ohnoes_default_style","hopper_happy_style","hopper_jumping_style","hopper_cool_style"],_n=["blobby-green","blobby-yellow","blobby-blue","blobby-purple","area-52-yellow","area-52-blue","area-52-green","area-52-purple","eggleston-blue","eggleston-yellow","eggleston-green","eggleston-orange","scuttlebug-purple","scuttlebug-yellow","scuttlebug-blue","scuttlebug-green","boggle-yellow","boggle-blue","boggle-green","boggle-purple","sneak-peak-green","sneak-peak-yellow","sneak-peak-blue","sneak-peak-purple","stelly-blue","stelly-yellow","stelly-green","stelly-orange","cacteye-purple","cacteye-yellow","cacteye-blue","cacteye-green","leaf-green","leaf-blue","leaf-grey","leaf-red","leaf-orange","leaf-yellow","leafers-seed","leafers-seedling","leafers-sapling","leafers-tree","leafers-ultimate","piceratops-seed","piceratops-seedling","piceratops-sapling","piceratops-tree","piceratops-ultimate","duskpin-seed","duskpin-seedling","duskpin-sapling","duskpin-tree","duskpin-ultimate","primosaur-seed","primosaur-seedling","primosaur-sapling","primosaur-tree","primosaur-ultimate","starky-seed","starky-seedling","starky-sapling","starky-tree","starky-ultimate","aqualine-seed","aqualine-seedling","aqualine-sapling","aqualine-tree","aqualine-ultimate","spunky-sam","spunky-sam-green","spunky-sam-orange","spunky-sam-red","marcimus","marcimus-orange","marcimus-red","marcimus-purple","mr-pink","mr-pink-green","mr-pink-orange","robot_female_1","robot_female_2","robot_female_3","robot_male_1","robot_male_2","robot_male_3","orange-juice-squid","purple-pi","purple-pi-pink","purple-pi-teal","mr-pants","mr-pants-green","mr-pants-orange","mr-pants-pink","mr-pants-purple","old-spice-man","old-spice-man-blue","cs-winston","cs-winston-baby","cs-ohnoes","cs-hopper-happy","cs-hopper-jumping","cs-hopper-cool"];function wn(e){return _n[gn.indexOf(e)]}function kn(e){return gn[_n.indexOf(e)]}function bn(e){return`https://www.khanacademy.org/images/avatars/svg/${e}.svg`}function vn(e){return`https://www.khanacademy.org/images/avatars/${e}.png`}function En(e){return e.match(/^(?:https:\/\/www\.khanacademy\.org)?\/images\/avatars(?:\/svg)?\/(.*)\.(?:(?:svg)|(?:png))$/)?.[1]??null}function Tn(e){const n=En(e);return n?vn(n):null}function Sn(e){const n=En(e);return n?bn(n):null}var An,Pn,Cn,In=class extends Ve{get bySelf(){return!!this.client?.user&&this.byUser(this.client.user)}get url(){if(!this.program?.url||!this.encryptedKey)return null;const e={qa_expand_key:this.key??this.encryptedKey,qa_expand_type:this.rawData?.feedbackType?.toLowerCase()},n=new URL(this.program.url);for(const[t,a]of Object.entries(e))a&&n.searchParams.set(t,a);return n.toString()}transformSchema(e){return{text:e.content,author:e.author&&en.fromSchema(e.author),program:(()=>{if("Scratchpad"===e.focus?.kind)return new fn({id:"string"==typeof e.focus.id?parseInt(e.focus.id,10):void 0,title:e.focus.translatedTitle});if(e.focusUrl){const n=e.focusUrl.match(W);if(!n||n.length<1)return;return new fn({id:parseInt(n[1],10)})}})(),created:e.date?new Date(e.date):void 0,key:e.expandKey,encryptedKey:e.key,deleted:e.appearsAsDeleted,locked:e.isLocked,pinned:e.isPinned,verified:e.definitelyNotSpam,score:e.lowQualityScore,byVideoAuthor:e.fromVideoAuthor,selfFlagged:e.flaggedByUser}}byUser(e){return!!this.author&&this.author.is(e)}is(e){return this.key&&e.key||this.encryptedKey&&e.encryptedKey?this.key&&e.key&&this.key===e.key||this.encryptedKey&&e.encryptedKey&&this.encryptedKey===e.encryptedKey||!1:(console.warn("Messages don't have any identifiers that can be compared"),!1)}},Nn=((An=Nn||{})[An.TipsAndThanks="COMMENT"]="TipsAndThanks",An[An.Question="QUESTION"]="Question",An[An.HelpRequest="PROJECT_HELP_QUESTION"]="HelpRequest",An),Rn=class e extends In{constructor(){super(...arguments),p(this,Pn)}get selfVoted(){return!1===this.client?.authenticated?null:this.selfUpvoted?1:this.selfDownvoted?-1:0}static fromSchema(n){const t=new e;return t.copyFromSchema(n),t.rawData=n,t}static fromIdentifier(n){return new e({key:ge(n)?n:void 0,encryptedKey:be(n)?n:void 0})}transformSchema(e){return{...super.transformSchema(e),votes:e.sumVotesIncremented,replyCount:e.replyCount,selfUpvoted:e.upVoted,selfDownvoted:e.downVoted}}copy(e){return super.copy(e)}async get(e=this.client??new Zn){const n=await e.getMessage(h(this,Pn,Cn).call(this));return this.copy(n)}async*getReplies(e=this.client??new Zn,n){for await(const t of e.getMessageReplies(h(this,Pn,Cn).call(this),n))this.replies||this.copy({replies:[]}),this.replies?.push(...t),yield t;return this}async getAllReplies(e=this.client??new Zn){if(!this.key&&!this.encryptedKey)throw new Error("Message does not have a key or encrypted key");const n=await e.getAllMessageReplies(this.key??this.encryptedKey);return this.copy({replies:n})}};Pn=new WeakSet,Cn=function(){if(this.key)return this.key;if(this.encryptedKey)return this.encryptedKey;throw new Error("Message does not have a key or encrypted key")},Rn.Type=Nn;var $n=Rn,xn=class e extends $n{static fromSchema(n){const t=new e;return t.copyFromSchema(n),t.rawData=n,t}static fromIdentifier(n){return new e({key:ge(n)?n:void 0,encryptedKey:be(n)?n:void 0})}transformSchema(e){return{...super.transformSchema(e),question:e.question?Un.fromSchema(e.question):void 0}}copy(e){return super.copy(e)}},Un=class e extends $n{static fromSchema(n){const t=new e;return t.copyFromSchema(n),t.rawData=n,t}static fromIdentifier(n){return new e({key:ge(n)?n:void 0,encryptedKey:be(n)?n:void 0})}transformSchema(e){return{...super.transformSchema(e),answerCount:e.answerCount,old:e.isOld,answers:(()=>{if(!e.answers)return;const n=e.answers.map((e=>xn.fromSchema(e)));return n.forEach((e=>e.copy({question:this}))),n})()}}copy(e){return super.copy(e)}},On=class e extends In{static fromSchema(n){const t=new e;return t.copyFromSchema(n),t.rawData=n,t}static fromIdentifier(n){return new e({key:ge(n)?n:void 0,encryptedKey:be(n)?n:void 0})}transformSchema(e){return{...super.transformSchema(e),message:(()=>{if(void 0!==e.replyExpandKeys)return"string"==typeof e.replyExpandKeys&&ge(e.replyExpandKeys)?new $n({key:e.replyExpandKeys}):Array.isArray(e.replyExpandKeys)?new $n({key:e.replyExpandKeys[0]}):void 0})()}}copy(e){return super.copy(e)}copyFromSchema(e){return super.copyFromSchema(e)}async get(e=this.client??new Zn){if(!this.key&&!this.encryptedKey)throw new Error("Message does not have a key or encrypted key");const n=await e.getMessage(this.key??this.encryptedKey);return this.copy(n)}},Dn=class e extends $n{static fromSchema(n){const t=new e;return t.copyFromSchema(n),t.rawData=n,t}static fromIdentifier(n){return new e({key:ge(n)?n:void 0,encryptedKey:be(n)?n:void 0})}transformSchema(e){return{...super.transformSchema(e),votes:e.sumVotesIncremented,replyCount:e.replyCount,selfUpvoted:e.upVoted,selfDownvoted:e.downVoted}}copy(e){return super.copy(e)}};function Ln(e){return"COMMENT"===e.feedbackType}function qn(e){return"REPLY"===e.feedbackType}function Mn(e){return"QUESTION"===e.feedbackType||"PROJECT_HELP_QUESTION"===e.feedbackType}function Kn(e){return"ANSWER"===e.feedbackType}var Bn,Fn,jn,Vn,Qn,Hn,Gn,Wn,Jn={[Nn.TipsAndThanks]:Dn,[Nn.Question]:Un,[Nn.HelpRequest]:Un},Yn=class e{constructor(){return p(this,Bn,void 0),p(this,Fn,void 0),p(this,jn,void 0),p(this,Vn,new Map),p(this,Qn,new Map),p(this,Hn,new Map),this.authenticated=!1,this.kaid=null,this}async resolveCachedKaid(e){if(F(e))return e;if(u(this,Vn).has(e))return u(this,Vn).get(e);const n=await cn(e);return u(this,Vn).set(e,n),n}async resolveCachedUsername(e){if(!F(e)&&!Ne(e)&&!Q(e))return e;if(u(this,Qn).has(e))return u(this,Qn).get(e);const n=await ln(e);return u(this,Qn).set(e,n),n}async resolveCachedFeedbackKey(e){if(ge(e))return e;if(u(this,Hn).has(e))return u(this,Hn).get(e);const n=await un(e);return u(this,Hn).set(e,n),n}get kaas(){return this.authenticated&&u(this,jn)?u(this,jn).match(/KAAS=([^;]+)/)?.[1]??null:null}async login(n,t){var a;if(n&&(F(n)&&(n=await this.resolveCachedUsername(n)),y(this,Bn,n)),t&&y(this,Fn,t),!u(this,Bn)||!u(this,Fn)){if(!u(this,Bn))throw new Error("Missing username or email");if(!u(this,Fn))throw new Error("Missing password");throw new Error("Missing username/email and password")}const r=await Be({identifier:u(this,Bn),password:u(this,Fn)},{credentials:"include"}),s=await h(a=e,Gn,Wn).call(a,r);if(rn(s),!s.data.loginWithPassword)throw new Error("Malformed response");if(s.data.loginWithPassword.error)switch(s.data.loginWithPassword.error.code){case Me.ErrorCode.INVALID_CREDENTIALS:throw new Error("Invalid Credentials error: Check your username/email and password");case Me.ErrorCode.TOO_MANY_ATTEMPTS:throw new Error("Too Many Attempts error: Rate-limited by Khan Academy");default:throw new Error("Unknown error code: "+s.data.loginWithPassword.error.code)}const i=r.headers.get("set-cookie");if(!i)throw new Error("No cookies returned: Something went wrong on Khan Academy's end");return y(this,jn,function(e){return e.replace(/[a-zA-Z]+, \d\d [A-Za-z0-9]+ \d{4} \d\d:\d\d:\d\d [a-zA-Z]+/g,"").replace(/; (Path|Expires|Max-Age|HttpOnly|Secure|SameSite)[^;,]*/g,"").replace(/,/g,";")}(i)),this.authenticated=!0,this.kaid="string"==typeof s.data.loginWithPassword.user?.kaid&&F(s.data.loginWithPassword.user.kaid)?s.data.loginWithPassword.user.kaid:null,null===this.kaid&&console.warn(`User ${n??this.kaas??"unknown"} does not have a valid KAID`),this}async getUser(n){var t;if(!n&&!this.authenticated)throw new Error("Not authenticated: You need to login or provide an indentifier");let a=null;n&&(Ne(n)&&(a=n),n=await this.resolveCachedKaid(n));const r=await Re(n,n?void 0:{credentials:"include",headers:{cookie:u(this,jn)}}),s=await h(t=e,Gn,Wn).call(t,r);if(rn(s),!s.data.user)throw new Error("User not found");const i=en.fromSchema(s.data.user);return i.client=this,!i.email&&a&&Ne(a)&&i.copy({email:a}),i.self&&(this.user=i),i.kaid&&(i.username&&!u(this,Vn).has(i.username)&&u(this,Vn).set(i.username,i.kaid),i.email&&!u(this,Vn).has(i.email)&&u(this,Vn).set(i.email,i.kaid)),i}async getUserAvatar(n=this.kaid??u(this,Bn),t="svg"){var a;if(!n)throw new Error("No identifier provided");n=await this.resolveCachedKaid(n);const r=await $(n),s=await h(a=e,Gn,Wn).call(a,r);if(rn(s),!s.data.user)throw new Error("User not found");const i=En(s.data.user.avatar.imageSrc);if(!i)throw new Error("User has no avatar");return"svg"===t?bn(i):vn(i)}async getUserStatistics(n=this.kaid??u(this,Bn)){var t;if(!n)throw new Error("No identifier provided");n=await this.resolveCachedKaid(n);const a=await $e(n),r=await h(t=e,Gn,Wn).call(t,a);if(rn(r),!r.data.user)throw new Error("User not found");return{votes:r.data.userSummary.statistics.votes,tipsAndThanks:r.data.userSummary.statistics.comments,questions:r.data.userSummary.statistics.questions,answers:r.data.userSummary.statistics.answers,helpRequests:r.data.userSummary.statistics.projectquestions,helpRequestAnswers:r.data.userSummary.statistics.projectanswers,replies:r.data.userSummary.statistics.replies,flags:r.data.userSummary.statistics.flags}}async*getUserPrograms(n,t="TOP",a=40){if(!n&&!this.authenticated)throw new Error("Not authenticated: You need to login or provide an indentifier");if(n??(n=this.kaid??this.user?.username??this.user?.email),!n)throw new Error("Missing identifier for logged in user");const r={kaid:await this.resolveCachedKaid(n),pageInfo:{cursor:null,itemsPerPage:a},sort:t},s=async n=>{var t;const a=await Le({...r,pageInfo:{...r.pageInfo,cursor:n}}),s=await h(t=e,Gn,Wn).call(t,a);if(rn(s),!s.data.user)throw new Error("User not found");if(!s.data.user.programs.complete&&!s.data.user.programs.cursor)throw new Error("Cursor not found");return{programs:s.data.user.programs.programs.map((e=>{const n=fn.fromSchema(e);return n.client=this,n})),cursor:s.data.user.programs.complete?null:s.data.user.programs.cursor}};let{programs:i,cursor:o}=await s();for(yield i;o;)({programs:i,cursor:o}=await s(o)),yield i}async getAllUserPrograms(e,n="TOP",t=100){const a=[];for await(const r of this.getUserPrograms(e,n,t))a.push(...r);return a}async getProgram(n){var t;n=dn(n);const a=await De(n),r=await h(t=e,Gn,Wn).call(t,a);if(rn(r),!r.data.programById)throw new Error("Program not found");const s=fn.fromSchema(r.data.programById);return s.client=this,this.user&&s.author?.kaid===this.kaid&&(s.copy({author:this.user}),console.debug(`Copied the client's user data to program ${s.title?`"${function(e,n,t="..."){return n=Math.max(0,n),e.length>n?e.slice(0,n-t.length)+t:e}(s.title,32)}"`:s.id??"unknown"} because the program's author matches the client user`)),s}async*getHotlistPrograms(n="HOT",t=40,a=!1){const r={onlyOfficialProjectSpinoffs:a,sort:n,pageInfo:{cursor:null,itemsPerPage:t}},s=async n=>{var t;const a=await Oe({...r,pageInfo:{...r.pageInfo,cursor:n}}),s=await h(t=e,Gn,Wn).call(t,a);if(rn(s),!s.data.listTopPrograms)throw new Error("Programs not found");if(!s.data.listTopPrograms.complete&&!s.data.listTopPrograms.cursor)throw new Error("Cursor not found");return{programs:s.data.listTopPrograms.programs.map((e=>{const n=fn.fromSchema(e);return n.client=this,n})),cursor:s.data.listTopPrograms.complete?null:s.data.listTopPrograms.cursor}};let{programs:i,cursor:o}=await s();for(yield i;o;)({programs:i,cursor:o}=await s(o)),yield i}async*getTopPrograms(e=40,n=!1){yield*this.getHotlistPrograms("TOP",e,n)}async*getRecentPrograms(e=40,n=!1){yield*this.getHotlistPrograms("RECENT",e,n)}async getMessage(n){var t;ge(n)||(n=await this.resolveCachedFeedbackKey(n));const a=await x({topicId:4669512406581248..toString(),focusKind:"Scratchpad",feedbackType:"COMMENT",currentSort:1,qaExpandKey:n}),r=await h(t=e,Gn,Wn).call(t,a);if(rn(r),!r.data.feedback||!r.data.feedback.feedback||0===r.data.feedback.feedback.length)throw new Error("Message not found");const s=r.data.feedback.feedback[0];let i;if(Ln(s))i=Dn.fromSchema(s);else{if(!Mn(s))throw new Error("Unknown message type");{const e=Un.fromSchema(s);if(e.key!==n){const t=e.answers?.find((e=>e.key===n));if(!t)throw new Error("Question or answer not found");i=t,i.copy({question:e})}else i=e}}return i.client=this,this.user&&i.author?.kaid===this.kaid&&(i.copy({author:this.user}),console.debug(`Copied the client's user data to comment ${i.key??i.encryptedKey??"unknown"} because the comment's author matches the client user`)),i}async getTipsAndThanks(e){return this.getMessage(e)}async getQuestion(e){return this.getMessage(e)}async getAnswer(e){return this.getMessage(e)}async getReply(n){var t;const a=await this.getMessage(n);if(!a.key)throw new Error("Message has no key");const r=await U(a.key),s=await h(t=e,Gn,Wn).call(t,r);if(rn(s),!s.data.feedbackReplies||0===s.data.feedbackReplies.length)throw new Error("Reply not found");const i=s.data.feedbackReplies.find((e=>e.expandKey===n||e.key===n));if(!i)throw new Error("Reply not found");const o=On.fromSchema(i);return o.client=this,o.copy({message:a}),this.user&&o.author?.kaid===this.kaid&&(o.copy({author:this.user}),console.debug(`Copied the client's user data to reply ${o.key??o.encryptedKey??"unknown"} because the reply's author matches the client user`)),o}async*getProgramMessages(n=$n.Type.TipsAndThanks,t,a=1){const r={topicId:(t=dn(t)).toString(),focusKind:"Scratchpad",feedbackType:n,currentSort:a},s=async t=>{var a;const s=await x({...r,cursor:t}),i=await h(a=e,Gn,Wn).call(a,s);if(rn(i),!i.data.feedback.feedback)throw new Error("Comments not found");if(!i.data.feedback.isComplete&&!i.data.feedback.cursor)throw new Error("Cursor not found");return{messages:i.data.feedback.feedback.map((e=>{const t=Jn[n].fromSchema(e);return t.client=this,t})),cursor:!i.data.feedback.isComplete&&i.data.feedback.cursor}};let{messages:i,cursor:o}=await s();for(yield i;o;)({messages:i,cursor:o}=await s(o)),yield i}async getAllProgramMessages(e=$n.Type.TipsAndThanks,n,t=1){const a=[];for await(const r of this.getProgramMessages(e,n,t))a.push(...r);return a}async*getProgramTipsAndThanks(e,n=1){yield*this.getProgramMessages($n.Type.TipsAndThanks,e,n)}async getAllProgramTipsAndThanks(e,n=1){return this.getAllProgramMessages($n.Type.TipsAndThanks,e,n)}async*getProgramQuestions(e,n=1){yield*this.getProgramMessages($n.Type.Question,e,n)}async getAllProgramQuestions(e,n=1){return this.getAllProgramMessages($n.Type.Question,e,n)}async*getProgramHelpRequests(e,n=1){yield*this.getProgramMessages($n.Type.HelpRequest,e,n)}async getAllProgramHelpRequests(e,n=1){return this.getAllProgramMessages($n.Type.HelpRequest,e,n)}async*getMessageReplies(n,t=10){const a={postKey:n,cursor:null,limit:t},r=async n=>{var t;const r=await O({...a,cursor:n}),s=await h(t=e,Gn,Wn).call(t,r);if(rn(s),!s.data.feedbackRepliesPaginated)throw new Error("Replies not found");if(!s.data.feedbackRepliesPaginated.isComplete&&!s.data.feedbackRepliesPaginated.cursor)throw new Error("Cursor not found");const i=s.data.feedbackRepliesPaginated.feedback;return i?{replies:i.map((e=>{const n=On.fromSchema(e);return n.client=this,n})),cursor:s.data.feedbackRepliesPaginated.isComplete?null:s.data.feedbackRepliesPaginated.cursor}:{replies:[],cursor:null}};let{replies:s,cursor:i}=await r();for(yield s;i;)({replies:s,cursor:i}=await r(i)),yield s}async getAllMessageReplies(n){var t;const a=await U(n),r=await h(t=e,Gn,Wn).call(t,a);if(rn(r),!r.data.feedbackReplies)throw new Error("Replies not found");return r.data.feedbackReplies.map((e=>{const n=On.fromSchema(e);return n.client=this,n}))}};Bn=new WeakMap,Fn=new WeakMap,jn=new WeakMap,Vn=new WeakMap,Qn=new WeakMap,Hn=new WeakMap,Gn=new WeakSet,Wn=async function(e){try{return await e.json()}catch(e){const n=e instanceof Error?e.message:"string"==typeof e?e:"Unknown error";throw new Error(`Failed to parse response JSON: ${n}`)}},p(Yn,Gn);var Zn=Yn;(e=>{l(a({},"__esModule",{value:!0}),e)})(f)})()},26:e=>{e.exports=JSON.parse('{"leafers_seedling_style":"Earn 10,000 energy points.","piceratops_seedling_style":"Earn 10,000 energy points.","duskpin_seedling_style":"Earn 10,000 energy points.","primosaur_seedling_style":"Earn 10,000 energy points.","starky_seedling_style":"Earn 10,000 energy points.","spunky_sam_blue_style":"Earn 10,000 energy points.","spunky_sam_green_style":"Earn 10,000 energy points.","spunky_sam_orange_style":"Earn 10,000 energy points.","spunky_sam_red_style":"Earn 10,000 energy points.","marcimus_pink_style":"Earn 10,000 energy points.","marcimus_orange_style":"Earn 10,000 energy points.","marcimus_red_style":"Earn 10,000 energy points.","marcimus_purple_style":"Earn 10,000 energy points.","mr_pink_red_style":"Earn 10,000 energy points.","mr_pink_green_style":"Earn 10,000 energy points.","mr_pink_orange_style":"Earn 10,000 energy points.","mr_pants_teal_style":"Earn 10,000 energy points.","mr_pants_green_style":"Earn 10,000 energy points.","mr_pants_orange_style":"Earn 10,000 energy points.","mr_pants_pink_style":"Earn 10,000 energy points.","mr_pants_purple_style":"Earn 10,000 energy points.","old_spice_man_green_style":"Earn 10,000 energy points.","old_spice_man_blue_style":"Earn 10,000 energy points.","leafers_sapling_style":"Earn 50,000 energy points.","piceratops_sapling_style":"Earn 50,000 energy points.","duskpin_sapling_style":"Earn 50,000 energy points.","primosaur_sapling_style":"Earn 50,000 energy points.","starky_sapling_style":"Earn 50,000 energy points.","female_robot_amelia_style":"Earn 50,000 energy points.","male_robot_johnny_style":"Earn 50,000 energy points.","orange_juice_squid_orange_style":"Earn 50,000 energy points.","purple_pi_purple_style":"Earn 50,000 energy points.","purple_pi_pink_style":"Earn 50,000 energy points.","purple_pi_teal_style":"Earn 50,000 energy points.","leafers_tree_style":"Earn 100,000 energy points.","piceratops_tree_style":"Earn 100,000 energy points.","duskpin_tree_style":"Earn 100,000 energy points.","primosaur_tree_style":"Earn 100,000 energy points.","starky_tree_style":"Earn 100,000 energy points.","female_robot_ada_style":"Earn 100,000 energy points.","male_robot_donald_style":"Earn 100,000 energy points.","leafers_ultimate_style":"Earn 250,000 energy points.","piceratops_ultimate_style":"Earn 250,000 energy points.","duskpin_ultimate_style":"Earn 250,000 energy points.","primosaur_ultimate_style":"Earn 250,000 energy points.","starky_ultimate_style":"Earn 250,000 energy points.","female_robot_grace_style":"Earn 250,000 energy points.","male_robot_hal_style":"Earn 250,000 energy points.","winston_default_style":"Make changes to an official program","winston_baby_style":"Make changes to another user\'s program","ohnoes_default_style":"Finish watching a computer programming talk-through","hopper_happy_style":"Create a program from scratch","hopper_jumping_style":"Complete a coding challenge","hopper_cool_style":"Complete a coding challenge"}')},489:e=>{e.exports=JSON.parse('{"hopper_happy_style":"Hopper","hopper_cool_style":"Cool Hopper","hopper_jumping_style":"Jumping Hopper","leafers_seed_style":"Leafers","leafers_seedling_style":"Leafers","leafers_sapling_style":"Leafers","leafers_tree_style":"Leafers","leafers_ultimate_style":"Leafers","piceratops_seed_style":"&Pi;ceratops","piceratops_seedling_style":"&Pi;ceratops","piceratops_sapling_style":"&Pi;ceratops","piceratops_tree_style":"&Pi;ceratops","piceratops_ultimate_style":"&Pi;ceratops","duskpin_seed_style":"Duskpin","duskpin_seedling_style":"Duskpin","duskpin_sapling_style":"Duskpin","duskpin_tree_style":"Duskpin","duskpin_ultimate_style":"Duskpin","primosaur_seed_style":"Primosaur","primosaur_seedling_style":"Primosaur","primosaur_sapling_style":"Primosaur","primosaur_tree_style":"Primosaur","primosaur_ultimate_style":"Primosaur","starky_seed_style":"Starky","starky_seedling_style":"Starky","starky_sapling_style":"Starky","starky_tree_style":"Starky","starky_ultimate_style":"Starky","aqualine_seed_style":"Aqualine","aqualine_seedling_style":"Aqualine","aqualine_sapling_style":"Aqualine","aqualine_tree_style":"Aqualine","aqualine_ultimate_style":"Aqualine","spunky_sam_blue_style":"Spunky Sam","spunky_sam_green_style":"Spunky Sam","spunky_sam_orange_style":"Spunky Sam","spunky_sam_red_style":"Spunky Sam","marcimus_pink_style":"Marcimus","marcimus_orange_style":"Marcimus","marcimus_red_style":"Marcimus","marcimus_purple_style":"Marcimus","mr_pink_red_style":"Mr. Pink","mr_pink_green_style":"Mr. Pink","mr_pink_orange_style":"Mr. Pink","female_robot_amelia_style":"Amelia","female_robot_ada_style":"Ada","female_robot_grace_style":"Grace","male_robot_johnny_style":"Johnny","male_robot_donald_style":"Donald","male_robot_hal_style":"Hal","orange_juice_squid_orange_style":"Orange Juice Squid","purple_pi_purple_style":"Purple Pi","purple_pi_pink_style":"Purple Pi","purple_pi_teal_style":"Purple Pi","mr_pants_teal_style":"Mr. Pants","mr_pants_green_style":"Mr. Pants","mr_pants_orange_style":"Mr. Pants","mr_pants_pink_style":"Mr. Pants","mr_pants_purple_style":"Mr. Pants","old_spice_man_green_style":"Old Spice Man","old_spice_man_blue_style":"Old Spice Man","winston_default_style":"Winston","winston_baby_style":"Baby Winston","ohnoes_default_style":"Oh noes, the Error Buddy"}')},593:e=>{e.exports=JSON.parse('{"AddFeedbackToDiscussion":"mutation AddFeedbackToDiscussion($focusKind: String, $focusId: String, $parentKey: String, $textContent: String!, $feedbackType: FeedbackType!, $fromVideoAuthor: Boolean, $shownLowQualityNotice: Boolean) {\\n  addFeedbackToDiscussion(focusKind: $focusKind, focusId: $focusId, parentKey: $parentKey, textContent: $textContent, feedbackType: $feedbackType, fromVideoAuthor: $fromVideoAuthor, shownLowQualityNotice: $shownLowQualityNotice) {\\n    feedback {\\n      appearsAsDeleted\\n      author {\\n        id\\n        kaid\\n        nickname\\n        avatar {\\n          name\\n          imageSrc\\n          __typename\\n        }\\n        __typename\\n      }\\n      content\\n      date\\n      definitelyNotSpam\\n      deleted\\n      downVoted\\n      expandKey\\n      feedbackType\\n      flaggedBy\\n      flags\\n      focusUrl\\n      focus {\\n        kind\\n        id\\n        translatedTitle\\n        relativeUrl\\n        __typename\\n      }\\n      fromVideoAuthor\\n      key\\n      notifyOnAnswer\\n      permalink\\n      qualityKind\\n      replyCount\\n      replyExpandKeys\\n      sumVotesIncremented\\n      upVoted\\n      __typename\\n    }\\n    lowQualityResponse {\\n      feedbackCode\\n      feedbackChar\\n      feedbackType\\n      showLowQualityNotice\\n      __typename\\n    }\\n    error {\\n      code\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n","clearBrandNewNotifications":"mutation clearBrandNewNotifications {\\n  clearBrandNewNotifications {\\n    error {\\n      code\\n      __typename\\n    }\\n    __typename\\n  }\\n}","feedbackQuery":"query feedbackQuery($topicId: String!, $focusKind: String!, $cursor: String, $limit: Int, $feedbackType: FeedbackType!, $currentSort: Int, $qaExpandKey: String) {\\n  feedback(focusId: $topicId, cursor: $cursor, limit: $limit, feedbackType: $feedbackType, focusKind: $focusKind, sort: $currentSort, qaExpandKey: $qaExpandKey, answersLimit: 1) {\\n    feedback {\\n      isLocked\\n      isPinned\\n      replyCount\\n      appearsAsDeleted\\n      author {\\n        id\\n        kaid\\n        nickname\\n        avatar {\\n          name\\n          imageSrc\\n          __typename\\n        }\\n        __typename\\n      }\\n      badges {\\n        name\\n        icons {\\n          smallUrl\\n          __typename\\n        }\\n        description\\n        __typename\\n      }\\n      content\\n      date\\n      definitelyNotSpam\\n      deleted\\n      downVoted\\n      expandKey\\n      feedbackType\\n      flaggedBy\\n      flaggedByUser\\n      flags\\n      focusUrl\\n      focus {\\n        kind\\n        id\\n        translatedTitle\\n        relativeUrl\\n        __typename\\n      }\\n      fromVideoAuthor\\n      key\\n      lowQualityScore\\n      notifyOnAnswer\\n      permalink\\n      qualityKind\\n      replyCount\\n      replyExpandKeys\\n      showLowQualityNotice\\n      sumVotesIncremented\\n      upVoted\\n      ... on QuestionFeedback {\\n        hasAnswered\\n        answers {\\n          isLocked\\n          isPinned\\n          replyCount\\n          appearsAsDeleted\\n          author {\\n            id\\n            kaid\\n            nickname\\n            avatar {\\n              name\\n              imageSrc\\n              __typename\\n            }\\n            __typename\\n          }\\n          badges {\\n            name\\n            icons {\\n              smallUrl\\n              __typename\\n            }\\n            description\\n            __typename\\n          }\\n          content\\n          date\\n          definitelyNotSpam\\n          deleted\\n          downVoted\\n          expandKey\\n          feedbackType\\n          flaggedBy\\n          flaggedByUser\\n          flags\\n          focusUrl\\n          focus {\\n            kind\\n            id\\n            translatedTitle\\n            relativeUrl\\n            __typename\\n          }\\n          fromVideoAuthor\\n          key\\n          lowQualityScore\\n          notifyOnAnswer\\n          permalink\\n          qualityKind\\n          replyCount\\n          replyExpandKeys\\n          showLowQualityNotice\\n          sumVotesIncremented\\n          upVoted\\n          __typename\\n        }\\n        isOld\\n        answerCount\\n        __typename\\n      }\\n      ... on AnswerFeedback {\\n        question {\\n          isLocked\\n          isPinned\\n          replyCount\\n          appearsAsDeleted\\n          author {\\n            id\\n            kaid\\n            nickname\\n            avatar {\\n              name\\n              imageSrc\\n              __typename\\n            }\\n            __typename\\n          }\\n          badges {\\n            name\\n            icons {\\n              smallUrl\\n              __typename\\n            }\\n            description\\n            __typename\\n          }\\n          content\\n          date\\n          definitelyNotSpam\\n          deleted\\n          downVoted\\n          expandKey\\n          feedbackType\\n          flaggedBy\\n          flaggedByUser\\n          flags\\n          focusUrl\\n          focus {\\n            kind\\n            id\\n            translatedTitle\\n            relativeUrl\\n            __typename\\n          }\\n          fromVideoAuthor\\n          key\\n          lowQualityScore\\n          notifyOnAnswer\\n          permalink\\n          qualityKind\\n          replyCount\\n          replyExpandKeys\\n          showLowQualityNotice\\n          sumVotesIncremented\\n          upVoted\\n          __typename\\n        }\\n        __typename\\n      }\\n      __typename\\n    }\\n    cursor\\n    isComplete\\n    sortedByDate\\n    __typename\\n  }\\n}\\n","getFeedbackRepliesPage":"query getFeedbackRepliesPage($postKey: String!, $cursor: String, $limit: Int!) {\\n  feedbackRepliesPaginated(feedbackKey: $postKey, cursor: $cursor, limit: $limit) {\\n    cursor\\n    isComplete\\n    feedback {\\n      isLocked\\n      isPinned\\n      expandKey\\n      appearsAsDeleted\\n      author {\\n        id\\n        kaid\\n        nickname\\n        avatar {\\n          name\\n          imageSrc\\n          __typename\\n        }\\n        __typename\\n      }\\n      content\\n      date\\n      definitelyNotSpam\\n      deleted\\n      downVoted\\n      expandKey\\n      feedbackType\\n      flaggedBy\\n      flaggedByUser\\n      flags\\n      focusUrl\\n      fromVideoAuthor\\n      key\\n      lowQualityScore\\n      notifyOnAnswer\\n      permalink\\n      qualityKind\\n      replyCount\\n      replyExpandKeys\\n      showLowQualityNotice\\n      sumVotesIncremented\\n      upVoted\\n      __typename\\n    }\\n    __typename\\n  }\\n}","getFullUserProfile":"query getFullUserProfile($kaid: String, $username: String) {\\n  user(kaid: $kaid, username: $username) {\\n    id\\n    kaid\\n    key\\n    userId\\n    email\\n    username\\n    profileRoot\\n    gaUserId\\n    isPhantom\\n    isDeveloper: hasPermission(name: \\"can_do_what_only_admins_can_do\\")\\n    isCurator: hasPermission(name: \\"can_curate_tags\\", scope: ANY_ON_CURRENT_LOCALE)\\n    isCreator: hasPermission(name: \\"has_creator_role\\", scope: ANY_ON_CURRENT_LOCALE)\\n    isPublisher: hasPermission(name: \\"can_publish\\", scope: ANY_ON_CURRENT_LOCALE)\\n    isModerator: hasPermission(name: \\"can_moderate_users\\", scope: GLOBAL)\\n    isParent\\n    isTeacher\\n    isFormalTeacher\\n    isDataCollectible\\n    isChild\\n    isOrphan\\n    isCoachingLoggedInUser\\n    canModifyCoaches\\n    nickname\\n    hideVisual\\n    joined\\n    points\\n    countVideosCompleted\\n    bio\\n    profile {\\n      accessLevel\\n      __typename\\n    }\\n    soundOn\\n    muteVideos\\n    showCaptions\\n    prefersReducedMotion\\n    noColorInVideos\\n    newNotificationCount\\n    canHellban: hasPermission(name: \\"can_ban_users\\", scope: GLOBAL)\\n    canMessageUsers: hasPermission(\\n      name: \\"can_send_moderator_messages\\"\\n      scope: GLOBAL\\n    )\\n    isSelf: isActor\\n    hasStudents: hasCoachees\\n    hasClasses\\n    hasChildren\\n    hasCoach\\n    badgeCounts\\n    homepageUrl\\n    isMidsignupPhantom\\n    includesDistrictOwnedData\\n    includesKmapDistrictOwnedData\\n    includesK4dDistrictOwnedData\\n    canAccessDistrictsHomepage\\n    preferredKaLocale {\\n      id\\n      kaLocale\\n      status\\n      __typename\\n    }\\n    underAgeGate {\\n      parentEmail\\n      daysUntilCutoff\\n      approvalGivenAt\\n      __typename\\n    }\\n    authEmails\\n    signupDataIfUnverified {\\n      email\\n      emailBounced\\n      __typename\\n    }\\n    pendingEmailVerifications {\\n      email\\n      __typename\\n    }\\n    hasAccessToAIGuideTeacher\\n    tosAccepted\\n    shouldShowAgeCheck\\n    birthMonthYear\\n    lastLoginCountry\\n    __typename\\n  }\\n  actorIsImpersonatingUser\\n  isAIGuideEnabled\\n  hasAccessToAIGuideDev\\n}","getNotificationsForUser":"query getNotificationsForUser($after: ID) {\\n  user {\\n    id\\n    notifications(after: $after) {\\n      notifications {\\n        __typename\\n        brandNew\\n        class_\\n        date\\n        kaid\\n        read\\n        url\\n        urlsafeKey\\n        ...ThreadCreatedNotificationType\\n        ...AssignmentDueDateNotificationType\\n        ...AssignmentCreatedNotificationType\\n        ...CoachRequestNotificationType\\n        ...BadgeNotificationType\\n        ...CourseMasteryGoalCreatedNotificationType\\n        ...ModeratorNotificationType\\n        ...ProgramFeedbackNotificationType\\n        ...CoachRequestAcceptedNotificationType\\n        ...AvatarNotificationType\\n        ...InfoNotificationType\\n        ...ResponseFeedbackNotificationType\\n        ...GroupedBadgeNotificationType\\n        ...UnitMasteryGoalCreatedNotificationType\\n        ...UnitMasteryDueDateCreatedNotificationType\\n        ...CourseMasteryDueDateCreatedNotificationType\\n        ...MasteryGoalDueDateApproachingCreatedNotificationType\\n      }\\n      pageInfo {\\n        nextCursor\\n        __typename\\n      }\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\\nfragment AssignmentCreatedNotificationType on AssignmentCreatedNotification {\\n  numAssignments\\n  contentTitle\\n  curationNodeIconURL\\n  className\\n  __typename\\n}\\n\\nfragment AssignmentDueDateNotificationType on AssignmentDueDateNotification {\\n  numAssignments\\n  dueDate\\n  contentTitle\\n  curationNodeIconURL\\n  __typename\\n}\\n\\nfragment AvatarNotificationType on AvatarNotification {\\n  name\\n  thumbnailSrc\\n  __typename\\n}\\n\\nfragment BadgeNotificationType on BadgeNotification {\\n  badgeName\\n  badge {\\n    description\\n    fullDescription\\n    name\\n    relativeUrl\\n    icons {\\n      compactUrl\\n      __typename\\n    }\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment CoachRequestAcceptedNotificationType on CoachRequestAcceptedNotification {\\n  isMultipleClassrooms\\n  student {\\n    id\\n    email\\n    nickname\\n    __typename\\n  }\\n  classroom {\\n    cacheId\\n    id\\n    name\\n    topics {\\n      id\\n      slug\\n      iconUrl\\n      key\\n      translatedStandaloneTitle\\n      __typename\\n    }\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment CoachRequestNotificationType on CoachRequestNotification {\\n  coachIsParent\\n  coach {\\n    id\\n    kaid\\n    nickname\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment CourseMasteryDueDateCreatedNotificationType on CourseMasteryDueDateCreatedNotification {\\n  dueDate\\n  course {\\n    id\\n    iconUrl\\n    translatedStandaloneTitle\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment CourseMasteryGoalCreatedNotificationType on CourseMasteryGoalCreatedNotification {\\n  curationNodeIconURL\\n  curationNodeTranslatedTitle\\n  masteryPercentage\\n  __typename\\n}\\n\\nfragment GroupedBadgeNotificationType on GroupedBadgeNotification {\\n  badgeNotifications {\\n    badge {\\n      badgeCategory\\n      description\\n      fullDescription\\n      name\\n      icons {\\n        compactUrl\\n        __typename\\n      }\\n      __typename\\n    }\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment InfoNotificationType on InfoNotification {\\n  notificationType\\n  __typename\\n}\\n\\nfragment MasteryGoalDueDateApproachingCreatedNotificationType on MasteryGoalDueDateApproachingCreatedNotification {\\n  classroomInfo: classroom {\\n    id\\n    cacheId\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment ModeratorNotificationType on ModeratorNotification {\\n  text\\n  __typename\\n}\\n\\nfragment ProgramFeedbackNotificationType on ProgramFeedbackNotification {\\n  authorAvatarSrc\\n  authorNickname\\n  feedbackType\\n  translatedScratchpadTitle\\n  content\\n  __typename\\n}\\n\\nfragment ResponseFeedbackNotificationType on ResponseFeedbackNotification {\\n  authorAvatarUrl\\n  authorNickname\\n  feedbackType\\n  focusTranslatedTitle\\n  content\\n  sumVotesIncremented\\n  __typename\\n}\\n\\nfragment ThreadCreatedNotificationType on ThreadCreatedNotification {\\n  coachee {\\n    id\\n    kaid\\n    nickname\\n    __typename\\n  }\\n  threadId\\n  flagged\\n  __typename\\n}\\n\\nfragment UnitMasteryDueDateCreatedNotificationType on UnitMasteryDueDateCreatedNotification {\\n  dueDate\\n  unit {\\n    id\\n    iconUrl\\n    translatedStandaloneTitle\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment UnitMasteryGoalCreatedNotificationType on UnitMasteryGoalCreatedNotification {\\n  numAssignmentsCount: numAssignments\\n  classroomInfo: classroom {\\n    cacheId\\n    id\\n    coach {\\n      id\\n      nickname\\n      __typename\\n    }\\n    __typename\\n  }\\n  unit {\\n    id\\n    iconUrl\\n    parent {\\n      id\\n      iconUrl\\n      __typename\\n    }\\n    __typename\\n  }\\n  __typename\\n}"}')}},n={};function t(a){var r=n[a];if(void 0!==r)return r.exports;var s=n[a]={exports:{}};return e[a].call(s.exports,s,s.exports,t),s.exports}t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{t(262);const e=t(626),n=t(503),a=document.querySelector("#notifications-container"),r=document.querySelector("#notifications-section"),s=document.querySelector("#loading-spinner-container");let i,o=!1;async function c(){try{const t=await(0,e.getNotificationData)("",i);if(t.value){const{notifications:e,cursor:s}=t.value;a.insertAdjacentHTML("beforeend",e.map(n.createNotificationString).join("")),(0,n.addReplyButtonEventListeners)(),null===s&&r.removeEventListener("scroll",l),i=s,o=!1}else{if(d&&"cookie"===t.error)return a.innerHTML=(0,n.createLoggedOutString)(),s?.remove(),void(d=!1);switch(t.error){case"cookie":a.innerHTML=(0,n.createNoCookieString)(),s?.remove();break;case"nonotifications":r.removeEventListener("scroll",l),s?.remove()}}}catch(e){console.error(e)}}function l(){!o&&Math.abs(r.scrollHeight-r.scrollTop-r.clientHeight)<=76&&(o=!0,c())}let d=!0;!async function(){try{const{prefetchData:e,prefetchCursor:t,theme:o}=await chrome.storage.local.get(["prefetchData","prefetchCursor","theme"]);(0,n.initUserInterface)(o);let d,u=!1;const p=document.getElementById("clear-notification-cache");if(p.onclick=async()=>{u||(d&&clearTimeout(d),u=!0,p.innerText="Clearing cache...",a.innerHTML="",r.removeEventListener("scroll",l),i="",await c(),p.innerText="Cache cleared",u=!1,d=setTimeout((()=>{p.innerText="Clear cache"}),4e3))},e)switch(e){case"info:cookie":a.innerHTML=(0,n.createNoCookieString)(),s?.remove();break;case"info:logout":a.innerHTML=(0,n.createLoggedOutString)();break;case"info:nonotifications":a.innerHTML=(0,n.createNoNotificationsString)(),s?.remove();break;default:{const s=e;if(!s)return;if(a.innerHTML=s.map(n.createNotificationString).join(""),(0,n.addReplyButtonEventListeners)(),!t)return;i=t,r.addEventListener("scroll",l,{passive:!0})}}else await c(),r.addEventListener("scroll",l,{passive:!0})}catch(e){console.error(e)}}()})()})();